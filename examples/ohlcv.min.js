var charts=(()=>{var x=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var O=Object.prototype.hasOwnProperty;var V=(i,t)=>{for(var e in t)x(i,e,{get:t[e],enumerable:!0})},$=(i,t,e,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of B(t))!O.call(i,o)&&o!==e&&x(i,o,{get:()=>t[o],enumerable:!(a=N(t,o))||a.enumerable});return i};var M=i=>$(x({},"__esModule",{value:!0}),i);var K={};V(K,{OHLCV:()=>Y,volumeFormatter:()=>I});function k(i,{ratio:t=.2,maxWidth:e=1600,minWidth:a=400,minHeight:o=300}={}){let s=document.querySelector(i),h=d3.min([s.offsetWidth,e]);h=d3.max([s.offsetWidth,a]);let d=d3.max([parseInt(t*h),o]);return[h,d]}var u=class{constructor(t,e={}){this.parse(t)}parse(t){this.X=this.parseX(t),this.Y=this.parseY(t),this.Z=this.parseZ(t);let e=(a,o)=>!isNaN(this.X[o])&&!isNaN(this.Y[o]);this.D=d3.map(t.values,e),this.I=d3.range(this.X.length),this.grouping=d3.group(this.I,a=>this.Z[a]),this.setColors(t)}parseX(t){return d3.map(t.values,e=>d3.isoParse(e[0]))}parseY(t){return d3.map(t.values,e=>e[1])}parseZ(t){return d3.map(t.values,e=>e[2])}getDomainX(){return d3.extent(this.X)}getRangeX(t,e){return[e.left,t.width-e.right]}getDomainY(){return d3.extent(this.Y)}getRangeY(t,e){return[t.height-e.bottom,e.top]}setColors(t){let e=t.z.reduce((a,o)=>(a[o.name]=o.color,a),{});this.colors=d3.scaleOrdinal().domain(Object.keys(e)).range(Object.values(e))}getColor(t){return this.colors(t)}createSVG(t,e){d3.select(t).selectAll("svg").remove(),this.svg=d3.select(t).append("svg").attr("viewBox",[0,0,e.width,e.height]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("font-size","13px").style("overflow","visible")}};var Q=d3.utcFormat("%b"),W=d3.utcFormat("%b %-d"),tt=d3.utcFormat("%b %Y"),z=d3.utcFormat("%b %-d, %Y"),et=d3.utcFormat("%B %-d, %Y");function X(){let i=null;return function(t){let e=t.getUTCFullYear();return i!==e?(i=e,z(t)):W(t)}}function D(i,t){var e=!0;return function(){e&&(i.apply(this,arguments),e=!1,setTimeout(()=>{e=!0},t))}}var f=500,U=4,Z=3,E=0,y=5,S=.2,G=.6,L=["#1ebc8c","#b2b2b2","#f34d27"];function I(i){return i<=0?"":i>=1e9?`${i/1e9}B`:`${i/1e6}M`}var Y=class extends u{parse(t){this.X=d3.map(t,e=>d3.isoParse(e[0])),this.Yo=d3.map(t,e=>e[1]),this.Yh=d3.map(t,e=>e[2]),this.Yl=d3.map(t,e=>e[3]),this.Yc=d3.map(t,e=>e[4]),this.Yv=d3.map(t,e=>e[5]),this.I=d3.range(this.X.length)}getDomainX(){return d3.extent(this.X)}getDomainY(){this.minPrice=d3.min(this.Yl);let t=d3.max(this.Yh);return this.yDomain=[this.minPrice,t+(t-this.minPrice)*.05],this.yDomainVolume=[0,d3.max(this.Yv)],this.yDomain}getColor(t){return L[1+Math.sign(this.Yo[t]-this.Yc[t])]}render(t){let[e,a]=k(t,{ratio:.35}),o={width:e,height:a},s={top:15,right:25,bottom:25,left:40},h=a-s.top-s.bottom;this.chartHeight=h;let p=h*.9,n=[s.top+p,s.top],l=[s.top+h,s.top+p],C=",f",v="",g=parseInt(this.X.length/10);g<1&&(g=1);let F=d3.filter(this.X,(r,R)=>R%g===0);this.xScale=d3.scaleBand(this.X,this.getRangeX(o,s)).padding(S).align(.1);let c=d3.scaleLinear(this.getDomainY(),n),m=d3.scaleLinear(this.yDomainVolume,l),P=X(),T=d3.axisBottom(this.xScale).tickFormat(P).tickValues(F).tickSize(U);this.bandWidth=this.xScale.step();let w=d3.axisLeft(c).ticks(p/40,C).tickSize(E),A=d3.axisRight(m).ticks(2).tickFormat(I).tickSize(3);this.createSVG(t,o);let _=this.bandWidth*S/2;this.svg.append("g").attr("transform",`translate(${_},${a-s.bottom+Z})`).call(T).call(r=>r.select(".domain").remove()),this.svg.append("g").attr("transform",`translate(${s.left-y},0)`).call(w).call(r=>r.select(".domain").remove()).call(r=>r.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",y).attr("x2",e+y-s.left-s.right)).call(r=>r.append("text").attr("x",-s.left).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(v)),this.svg.append("g").attr("transform",`translate(${e-s.right},0)`).call(A).call(r=>r.select(".domain").remove()).call(r=>r.append("text").attr("x",-s.left).attr("fill","currentColor").attr("text-anchor","start").text(v));let b=this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",r=>`translate(${this.xScale(this.X[r])+this.bandWidth/2},0)`);b.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("opacity",.8).attr("y1",c(this.minPrice)).attr("y2",c(this.minPrice)).transition().duration(f).attr("y1",r=>c(this.Yl[r])).attr("y2",r=>c(this.Yh[r])),b.append("line").attr("stroke-width",this.xScale.bandwidth()).attr("stroke",r=>this.getColor(r)).attr("y1",c(this.minPrice)).attr("y2",c(this.minPrice)).transition().duration(f).attr("y1",r=>c(this.Yo[r])).attr("y2",r=>c(this.Yc[r])),this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",r=>`translate(${this.xScale(this.X[r])+this.bandWidth/2},0)`).append("line").attr("y1",m(0)).attr("y2",m(0)).attr("stroke-width",this.xScale.bandwidth()).attr("stroke",r=>this.getColor(r)).style("opacity",G).transition().duration(f).attr("y2",r=>m(this.Yv[r]))}enableHover(t,e){let a=d3.map(this.X,d=>[this.xScale(d)+this.bandWidth/2,1]),o=d3.Delaunay.from(a),s=null,h=d=>{let[p]=d3.pointer(d),n=o.find(p,1);if(s&&s==n)return;s=n;let l={x:this.X[n],o:this.Yo[n],h:this.Yh[n],l:this.Yl[n],c:this.Yc[n],v:this.Yv[n]};n>0&&(l.prev=this.Yc[n-1],l.prev&&(l.delta=l.c-l.prev,l.percent=l.delta/l.prev)),t&&t.call(this,l)};this.svg.on("pointermove",D(h,20)),e&&this.svg.on("pointerleave",e)}};return M(K);})();
//# sourceMappingURL=ohlcv.min.js.map
