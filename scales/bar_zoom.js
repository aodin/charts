const data = {"categories": [{"id": 338, "name": "Equinix", "color": ""}, {"id": 423, "name": "Digital Realty", "color": ""}, {"id": 253, "name": "NTT", "color": ""}, {"id": 256, "name": "China Telecom", "color": ""}, {"id": 367, "name": "CyrusOne", "color": ""}, {"id": 449, "name": "GDS", "color": ""}, {"id": 361, "name": "KDDI (Telehouse)", "color": ""}, {"id": 899, "name": "Evoque", "color": ""}, {"id": 349, "name": "CoreSite", "color": ""}, {"id": 988, "name": "Chindata", "color": ""}, {"id": 259, "name": "China Mobile", "color": ""}, {"id": 353, "name": "QTS", "color": ""}], "quarters": ["2015-03-31", "2015-06-30", "2015-09-30", "2015-12-31", "2016-03-31", "2016-06-30", "2016-09-30", "2016-12-31", "2017-03-31", "2017-06-30", "2017-09-30", "2017-12-31", "2018-03-31", "2018-06-30", "2018-09-30", "2018-12-31", "2019-03-31", "2019-06-30", "2019-09-30", "2019-12-31", "2020-03-31", "2020-06-30", "2020-09-30", "2020-12-31", "2021-03-31", "2021-06-30", "2021-09-30", "2021-12-31", "2022-03-31", "2022-06-30", "2022-09-30", "2022-12-31", "2023-03-31", "2023-06-30", "2023-09-30", "2023-12-31", "2024-03-31"], "values": [["2015-03-31", 338, 583203000.0], ["2015-06-30", 338, 601271000.0], ["2015-09-30", 338, 622220000.0], ["2015-12-31", 338, 654078000.0], ["2016-03-31", 338, 747098000.0], ["2016-06-30", 338, 798390000.0], ["2016-09-30", 338, 816030000.0], ["2016-12-31", 338, 834410000.0], ["2017-03-31", 338, 839582000.0], ["2017-06-30", 338, 947915000.0], ["2017-09-30", 338, 1022224000.0], ["2017-12-31", 338, 1049597000.0], ["2018-03-31", 338, 1076383000.0], ["2018-06-30", 338, 1111198000.0], ["2018-09-30", 338, 1132160000.0], ["2018-12-31", 338, 1152395000.0], ["2019-03-31", 338, 1193555000.0], ["2019-06-30", 338, 1224646000.0], ["2019-09-30", 338, 1239871000.0], ["2019-12-31", 338, 1257724000.0], ["2020-03-31", 338, 1276518000.0], ["2020-06-30", 338, 1304876000.0], ["2020-09-30", 338, 1328507000.0], ["2020-12-31", 338, 1370358000.0], ["2021-03-31", 338, 1410011000.0], ["2021-06-30", 338, 1443709000.0], ["2021-09-30", 338, 1455307000.0], ["2021-12-31", 338, 1494689000.0], ["2022-03-31", 338, 1528585000.0], ["2022-06-30", 338, 1572139000.0], ["2022-09-30", 338, 1614343000.0], ["2022-12-31", 338, 1635819000.0], ["2023-03-31", 338, 1745221000.0], ["2023-06-30", 338, 1771088000.0], ["2023-09-30", 338, 1816939000.0], ["2023-12-31", 338, 1827123000.0], ["2024-03-31", 338, 1858000000.0], ["2015-03-31", 423, 378930000.0], ["2015-06-30", 423, 392981000.0], ["2015-09-30", 423, 408476000.0], ["2015-12-31", 423, 468373000.0], ["2016-03-31", 423, 477046000.0], ["2016-06-30", 423, 487835000.0], ["2016-09-30", 423, 517279000.0], ["2016-12-31", 423, 518112000.0], ["2017-03-31", 423, 524784000.0], ["2017-06-30", 423, 539625000.0], ["2017-09-30", 423, 578784000.0], ["2017-12-31", 423, 675735000.0], ["2018-03-31", 423, 691732000.0], ["2018-06-30", 423, 696938000.0], ["2018-09-30", 423, 710173000.0], ["2018-12-31", 423, 722281000.0], ["2019-03-31", 423, 729426000.0], ["2019-06-30", 423, 737052000.0], ["2019-09-30", 423, 745006000.0], ["2019-12-31", 423, 722827000.0], ["2020-03-31", 423, 763129000.0], ["2020-06-30", 423, 925045000.0], ["2020-09-30", 423, 967277000.0], ["2020-12-31", 423, 995783000.0], ["2021-03-31", 423, 1028578000.0], ["2021-06-30", 423, 1029134000.0], ["2021-09-30", 423, 1053238000.0], ["2021-12-31", 423, 1048307000.0], ["2022-03-31", 423, 1070040000.0], ["2022-06-30", 423, 1078849000.0], ["2022-09-30", 423, 1134745000.0], ["2022-12-31", 423, 1179387000.0], ["2023-03-31", 423, 1289819000.0], ["2023-06-30", 423, 1304235000.0], ["2023-09-30", 423, 1329742000.0], ["2023-12-31", 423, 1308741000.0], ["2024-03-31", 423, 1278837000.0], ["2015-03-31", 253, 276837617.8], ["2015-06-30", 253, 273208510.1], ["2015-09-30", 253, 334438134.7], ["2015-12-31", 253, 342906056.2], ["2016-03-31", 253, 380745602.3], ["2016-06-30", 253, 389950376.5], ["2016-09-30", 253, 411671086.3], ["2016-12-31", 253, 407809913.0], ["2017-03-31", 253, 421259970.7], ["2017-06-30", 253, 426332141.7], ["2017-09-30", 253, 440697458.2], ["2017-12-31", 253, 465909513.0], ["2018-03-31", 253, 494007791.0], ["2018-06-30", 253, 493155541.4], ["2018-09-30", 253, 509725279.7], ["2018-12-31", 253, 522072485.5], ["2019-03-31", 253, 546101235.6], ["2019-06-30", 253, 545705718.4], ["2019-09-30", 253, 576165710.5], ["2019-12-31", 253, 589267396.5], ["2020-03-31", 253, 601541215.1], ["2020-06-30", 253, 604858659.0], ["2020-09-30", 253, 636751964.9], ["2020-12-31", 253, 660849587.2], ["2021-03-31", 253, 678889530.2], ["2021-06-30", 253, 687106545.0], ["2021-09-30", 253, 701178214.3], ["2021-12-31", 253, 710091358.4], ["2022-03-31", 253, 722044502.5], ["2022-06-30", 253, 687095384.5], ["2022-09-30", 253, 700772450.7], ["2022-12-31", 253, 714494175.9], ["2023-03-31", 253, 744431694.4], ["2023-06-30", 253, 756571653.6], ["2023-09-30", 253, 768492256.7], ["2023-12-31", 253, 792872636.9], ["2024-03-31", 253, 803668367.2], ["2015-03-31", 256, 126410294.4], ["2015-06-30", 256, 137846881.5], ["2015-09-30", 256, 143410722.2], ["2015-12-31", 256, 147675013.9], ["2016-03-31", 256, 157403948.9], ["2016-06-30", 256, 170156719.7], ["2016-09-30", 256, 177958691.6], ["2016-12-31", 256, 181096382.3], ["2017-03-31", 256, 186631767.2], ["2017-06-30", 256, 193313875.3], ["2017-09-30", 256, 198771294.8], ["2017-12-31", 256, 207540290.4], ["2018-03-31", 256, 219146846.7], ["2018-06-30", 256, 229156234.1], ["2018-09-30", 256, 223927605.3], ["2018-12-31", 256, 234109844.9], ["2019-03-31", 256, 244123695.3], ["2019-06-30", 256, 251066213.6], ["2019-09-30", 256, 252490971.1], ["2019-12-31", 256, 261668335.9], ["2020-03-31", 256, 269214688.1], ["2020-06-30", 256, 275196324.0], ["2020-09-30", 256, 282125158.3], ["2020-12-31", 256, 292918043.4], ["2021-03-31", 256, 305728282.5], ["2021-06-30", 256, 319523846.5], ["2021-09-30", 256, 326167259.2], ["2021-12-31", 256, 335575719.6], ["2022-03-31", 256, 350464680.9], ["2022-06-30", 256, 350541816.0], ["2022-09-30", 256, 349549970.8], ["2022-12-31", 256, 347532267.1], ["2023-03-31", 256, 374929962.0], ["2023-06-30", 256, 381287284.1], ["2023-09-30", 256, 377384572.9], ["2023-12-31", 256, 388086642.6], ["2024-03-31", 256, 399720475.2], ["2015-03-31", 367, 85700000.0], ["2015-06-30", 367, 89100000.0], ["2015-09-30", 367, 106214280.8], ["2015-12-31", 367, 108232847.4], ["2016-03-31", 367, 112624354.0], ["2016-06-30", 367, 124708236.8], ["2016-09-30", 367, 138204856.4], ["2016-12-31", 367, 131476050.2], ["2017-03-31", 367, 143063258.8], ["2017-06-30", 367, 160372023.1], ["2017-09-30", 367, 168494377.6], ["2017-12-31", 367, 173351726.5], ["2018-03-31", 367, 189208588.4], ["2018-06-30", 367, 189221010.4], ["2018-09-30", 367, 198685633.0], ["2018-12-31", 367, 213207456.5], ["2019-03-31", 367, 216630737.5], ["2019-06-30", 367, 229056007.6], ["2019-09-30", 367, 242190422.6], ["2019-12-31", 367, 245074961.5], ["2020-03-31", 367, 237517865.4], ["2020-06-30", 367, 248044211.8], ["2020-09-30", 367, 254466166.9], ["2020-12-31", 367, 260032593.8], ["2021-03-31", 367, 263182182.8], ["2021-06-30", 367, 276126803.4], ["2021-09-30", 367, 289572164.5], ["2021-12-31", 367, 303819004.2], ["2022-03-31", 367, 305093945.4], ["2022-06-30", 367, 302773039.9], ["2022-09-30", 367, 308104783.0], ["2022-12-31", 367, 319769501.9], ["2023-03-31", 367, 328738726.2], ["2023-06-30", 367, 332690134.8], ["2023-09-30", 367, 339223366.1], ["2023-12-31", 367, 353185414.9], ["2024-03-31", 367, 365886202.3], ["2015-03-31", 449, 18042964.4], ["2015-06-30", 449, 18539159.9], ["2015-09-30", 449, 20637807.2], ["2015-12-31", 449, 23213565.5], ["2016-03-31", 449, 23831258.6], ["2016-06-30", 449, 27589603.4], ["2016-09-30", 449, 30628690.4], ["2016-12-31", 449, 33400214.6], ["2017-03-31", 449, 38318048.8], ["2017-06-30", 449, 38646458.8], ["2017-09-30", 449, 47554181.7], ["2017-12-31", 449, 56348923.5], ["2018-03-31", 449, 66429991.8], ["2018-06-30", 449, 75676634.2], ["2018-09-30", 449, 84116352.9], ["2018-12-31", 449, 90771022.6], ["2019-03-31", 449, 103675157.1], ["2019-06-30", 449, 114670083.0], ["2019-09-30", 449, 120777986.9], ["2019-12-31", 449, 132559791.3], ["2020-03-31", 449, 144449541.8], ["2020-06-30", 449, 154637117.1], ["2020-09-30", 449, 181546866.9], ["2020-12-31", 449, 204076798.6], ["2021-03-31", 449, 219212881.9], ["2021-06-30", 449, 241199788.8], ["2021-09-30", 449, 265722791.2], ["2021-12-31", 449, 285200991.6], ["2022-03-31", 449, 296309271.9], ["2022-06-30", 449, 289560606.0], ["2022-09-30", 449, 292316786.2], ["2022-12-31", 449, 288362664.1], ["2023-03-31", 449, 304126423.4], ["2023-06-30", 449, 305165877.0], ["2023-09-30", 449, 301204861.8], ["2023-12-31", 449, 308823424.0], ["2024-03-31", 449, 319470201.3], ["2015-03-31", 361, 149228763.2], ["2015-06-30", 361, 141587363.4], ["2015-09-30", 361, 152703383.8], ["2015-12-31", 361, 159498899.2], ["2016-03-31", 361, 170406842.8], ["2016-06-30", 361, 178415588.8], ["2016-09-30", 361, 191912334.9], ["2016-12-31", 361, 190009044.7], ["2017-03-31", 361, 190685124.8], ["2017-06-30", 361, 201132759.0], ["2017-09-30", 361, 205137260.5], ["2017-12-31", 361, 207938102.4], ["2018-03-31", 361, 217165119.9], ["2018-06-30", 361, 226163695.2], ["2018-09-30", 361, 226467405.6], ["2018-12-31", 361, 232842695.2], ["2019-03-31", 361, 235125249.0], ["2019-06-30", 361, 239609500.3], ["2019-09-30", 361, 244912626.1], ["2019-12-31", 361, 248524967.3], ["2020-03-31", 361, 250217249.4], ["2020-06-30", 361, 251814694.6], ["2020-09-30", 361, 256302078.3], ["2020-12-31", 361, 262422890.0], ["2021-03-31", 361, 265671934.9], ["2021-06-30", 361, 261921506.6], ["2021-09-30", 361, 265624186.6], ["2021-12-31", 361, 269822915.2], ["2022-03-31", 361, 273526855.2], ["2022-06-30", 361, 253803039.2], ["2022-09-30", 361, 259866518.5], ["2022-12-31", 361, 262407257.2], ["2023-03-31", 361, 266194836.0], ["2023-06-30", 361, 266679704.8], ["2023-09-30", 361, 277136769.3], ["2023-12-31", 361, 291242765.8], ["2024-03-31", 361, 298723982.4], ["2015-03-31", 899, 0.0], ["2015-06-30", 899, 0.0], ["2015-09-30", 899, 0.0], ["2015-12-31", 899, 0.0], ["2016-03-31", 899, 0.0], ["2016-06-30", 899, 0.0], ["2016-09-30", 899, 0.0], ["2016-12-31", 899, 0.0], ["2017-03-31", 899, 0.0], ["2017-06-30", 899, 0.0], ["2017-09-30", 899, 0.0], ["2017-12-31", 899, 0.0], ["2018-03-31", 899, 0.0], ["2018-06-30", 899, 0.0], ["2018-09-30", 899, 0.0], ["2018-12-31", 899, 0.0], ["2019-03-31", 899, 71974280.5], ["2019-06-30", 899, 72199774.8], ["2019-09-30", 899, 71806979.4], ["2019-12-31", 899, 72138965.3], ["2020-03-31", 899, 69275245.0], ["2020-06-30", 899, 66640392.1], ["2020-09-30", 899, 66600973.4], ["2020-12-31", 899, 65023389.5], ["2021-03-31", 899, 64945542.2], ["2021-06-30", 899, 63808175.5], ["2021-09-30", 899, 63603929.6], ["2021-12-31", 899, 63560363.2], ["2022-03-31", 899, 64296086.8], ["2022-06-30", 899, 63297710.1], ["2022-09-30", 899, 60105713.4], ["2022-12-31", 899, 58793336.0], ["2023-03-31", 899, 57223517.2], ["2023-06-30", 899, 57917404.7], ["2023-09-30", 899, 58002013.5], ["2023-12-31", 899, 58675749.3], ["2024-03-31", 899, 238367987.6], ["2015-03-31", 349, 74757000.0], ["2015-06-30", 349, 81456000.0], ["2015-09-30", 349, 86555000.0], ["2015-12-31", 349, 90919000.0], ["2016-03-31", 349, 92480000.0], ["2016-06-30", 349, 96090000.0], ["2016-09-30", 349, 101274000.0], ["2016-12-31", 349, 110508000.0], ["2017-03-31", 349, 114921000.0], ["2017-06-30", 349, 117886000.0], ["2017-09-30", 349, 123068000.0], ["2017-12-31", 349, 125946000.0], ["2018-03-31", 349, 129619000.0], ["2018-06-30", 349, 136447000.0], ["2018-09-30", 349, 139180000.0], ["2018-12-31", 349, 139146000.0], ["2019-03-31", 349, 138895000.0], ["2019-06-30", 349, 142906000.0], ["2019-09-30", 349, 144891000.0], ["2019-12-31", 349, 146035000.0], ["2020-03-31", 349, 147362000.0], ["2020-06-30", 349, 150543000.0], ["2020-09-30", 349, 153981000.0], ["2020-12-31", 349, 154938000.0], ["2021-03-31", 349, 157642000.0], ["2021-06-30", 349, 162124000.0], ["2021-09-30", 349, 162219420.0], ["2021-12-31", 349, 164050000.0], ["2022-03-31", 349, 173196880.0], ["2022-06-30", 349, 178667280.0], ["2022-09-30", 349, 182086460.0], ["2022-12-31", 349, 185616066.0], ["2023-03-31", 349, 190847072.0], ["2023-06-30", 349, 193183923.0], ["2023-09-30", 349, 201305000.0], ["2023-12-31", 349, 205229500.0], ["2024-03-31", 349, 215616000.0], ["2015-03-31", 988, 0.0], ["2015-06-30", 988, 0.0], ["2015-09-30", 988, 0.0], ["2015-12-31", 988, 0.0], ["2016-03-31", 988, 0.0], ["2016-06-30", 988, 0.0], ["2016-09-30", 988, 0.0], ["2016-12-31", 988, 0.0], ["2017-03-31", 988, 3448025.6], ["2017-06-30", 988, 5537744.1], ["2017-09-30", 988, 7831235.0], ["2017-12-31", 988, 8618082.9], ["2018-03-31", 988, 9710646.3], ["2018-06-30", 988, 14906637.4], ["2018-09-30", 988, 14877670.0], ["2018-12-31", 988, 17560825.7], ["2019-03-31", 988, 29573080.3], ["2019-06-30", 988, 34144289.7], ["2019-09-30", 988, 35777518.0], ["2019-12-31", 988, 44749829.6], ["2020-03-31", 988, 50605788.0], ["2020-06-30", 988, 53114354.3], ["2020-09-30", 988, 60817519.5], ["2020-12-31", 988, 72975120.1], ["2021-03-31", 988, 85511218.2], ["2021-06-30", 988, 91502282.8], ["2021-09-30", 988, 99850598.2], ["2021-12-31", 988, 107956210.9], ["2022-03-31", 988, 128455035.5], ["2022-06-30", 988, 137513037.6], ["2022-09-30", 988, 158157904.7], ["2022-12-31", 988, 171636296.3], ["2023-03-31", 988, 185448373.7], ["2023-06-30", 988, 195138838.3], ["2023-09-30", 988, 199502350.0], ["2023-12-31", 988, 207720077.8], ["2024-03-31", 988, 215234102.0], ["2015-03-31", 259, 9099260.2], ["2015-06-30", 259, 10748776.6], ["2015-09-30", 259, 12107986.7], ["2015-12-31", 259, 13421025.0], ["2016-03-31", 259, 15337402.7], ["2016-06-30", 259, 17705942.6], ["2016-09-30", 259, 19372778.8], ["2016-12-31", 259, 22815742.5], ["2017-03-31", 259, 26160888.5], ["2017-06-30", 259, 31817837.4], ["2017-09-30", 259, 37062859.7], ["2017-12-31", 259, 43770940.4], ["2018-03-31", 259, 51800597.6], ["2018-06-30", 259, 60950777.3], ["2018-09-30", 259, 65661764.7], ["2018-12-31", 259, 72317037.9], ["2019-03-31", 259, 79899199.5], ["2019-06-30", 259, 87230611.3], ["2019-09-30", 259, 89820359.3], ["2019-12-31", 259, 99226072.1], ["2020-03-31", 259, 105300859.6], ["2020-06-30", 259, 112769654.2], ["2020-09-30", 259, 118531367.4], ["2020-12-31", 259, 129000000.0], ["2021-03-31", 259, 146672842.4], ["2021-06-30", 259, 155133963.1], ["2021-09-30", 259, 158602566.1], ["2021-12-31", 259, 163485607.0], ["2022-03-31", 259, 179275019.7], ["2022-06-30", 259, 183990442.1], ["2022-09-30", 259, 184804208.1], ["2022-12-31", 259, 181369248.0], ["2023-03-31", 259, 197080292.0], ["2023-06-30", 259, 199800199.8], ["2023-09-30", 259, 196433508.4], ["2023-12-31", 259, 199944459.9], ["2024-03-31", 259, 205450733.8], ["2015-03-31", 353, 56229822.0], ["2015-06-30", 353, 59896588.0], ["2015-09-30", 353, 70317000.0], ["2015-12-31", 353, 73317790.0], ["2016-03-31", 353, 75878000.0], ["2016-06-30", 353, 81672000.0], ["2016-09-30", 353, 87222000.0], ["2016-12-31", 353, 89103000.0], ["2017-03-31", 353, 88999000.0], ["2017-06-30", 353, 91012000.0], ["2017-09-30", 353, 95529000.0], ["2017-12-31", 353, 101131000.0], ["2018-03-31", 353, 97226000.0], ["2018-06-30", 353, 99676000.0], ["2018-09-30", 353, 103533000.0], ["2018-12-31", 353, 105779000.0], ["2019-03-31", 353, 107201220.0], ["2019-06-30", 353, 112677460.0], ["2019-09-30", 353, 119045500.0], ["2019-12-31", 353, 116896360.0], ["2020-03-31", 353, 117679380.0], ["2020-06-30", 353, 123476080.0], ["2020-09-30", 353, 131106360.0], ["2020-12-31", 353, 137198040.0], ["2021-03-31", 353, 141421840.0], ["2021-06-30", 353, 147790860.0], ["2021-09-30", 353, 150772314.0], ["2021-12-31", 353, 154347795.0], ["2022-03-31", 353, 159099570.0], ["2022-06-30", 353, 165525763.2], ["2022-09-30", 353, 168111130.1], ["2022-12-31", 353, 172097791.4], ["2023-03-31", 353, 174214029.1], ["2023-06-30", 353, 181581762.2], ["2023-09-30", 353, 184712104.2], ["2023-12-31", 353, 189479668.4], ["2024-03-31", 353, 193638893.4]], "others": [["2015-03-31", 4420040214.6], ["2015-06-30", 4517543140.7], ["2015-09-30", 4548513197.4], ["2015-12-31", 4558393417.1], ["2016-03-31", 4528584160.0], ["2016-06-30", 4647832039.8], ["2016-09-30", 4710699808.4], ["2016-12-31", 4765952621.8], ["2017-03-31", 4840579310.3], ["2017-06-30", 4881503638.0], ["2017-09-30", 4986166032.7], ["2017-12-31", 4997141088.1], ["2018-03-31", 5145935544.9], ["2018-06-30", 5201464961.2], ["2018-09-30", 5246129399.3], ["2018-12-31", 5324209667.8], ["2019-03-31", 5346453251.8], ["2019-06-30", 5435381998.3], ["2019-09-30", 5538624509.0], ["2019-12-31", 5675328860.5], ["2020-03-31", 5744941581.5], ["2020-06-30", 5706298995.4], ["2020-09-30", 5943885132.7], ["2020-12-31", 6121289258.8], ["2021-03-31", 6265494939.6], ["2021-06-30", 6429407216.9], ["2021-09-30", 6547838825.6], ["2021-12-31", 6682965297.4], ["2022-03-31", 6787176826.1], ["2022-06-30", 6784959996.2], ["2022-09-30", 6871908486.7], ["2022-12-31", 6985102468.9], ["2023-03-31", 7270479011.5], ["2023-06-30", 7464218438.9], ["2023-09-30", 7707417741.3], ["2023-12-31", 7900099712.8], ["2024-03-31", 7909929832.2]], "decimals": 1, "magnitude": 1000000.0, "kind": "bars"};

// Layout
const margin = {
  top: 0,
  right: 15,
  bottom: 25,
  left: 75,
};

const svg = d3.select("#chart")
const width = +svg.attr("width");
const height = +svg.attr("height");
const innerHeight = height - margin.top - margin.bottom;
const innerWidth = width - margin.left - margin.right;

// Show only one company's values
let values = d3.filter(data.values, d => d[1] == 338);

const X = d3.map(values, (d) => d3.isoParse(d[0]));
const Z = d3.map(values, (d) => d[1]);
const Y = d3.map(values, (d) => d[2]);

const xScale = d3.scaleUtc(d3.extent(X), [margin.left, margin.left + innerWidth])
// const yScale = d3.scaleLinear(d3.extent(Y), [margin.top, margin.top + innerHeight])
const yScale = d3.scaleLinear([0, d3.max(Y)], [margin.top + innerHeight, margin.top])

const xAxis = d3
  .axisBottom(xScale)
  // .tickValues(filteredX)
  // .tickFormat(d3.timeFormat(TIME_FORMAT));

const yAxis = d3.axisLeft(yScale);

// Axes
const inner = svg.append("g")
  // .attr("transform", `translate(${}, ${margin.top})`);

const xAxisElement = inner
  .append("g")
  .attr("class", "x axis")
  .attr("transform", `translate(${0},${margin.top + innerHeight})`)
  .call(xAxis)

const bandWidth = width / X.length;

const bars = inner.append('g')
  .selectAll('rect')
  .data(X)
  .enter()
  .append('rect')
  .attr('y', (d, i) => margin.top + yScale(Y[i]))
  .attr('x', (d, i) => xScale(d) - bandWidth * .45)
  .attr('width', (d,i) => bandWidth * 0.85)
  .attr('height', (d, i) => innerHeight - yScale(Y[i]))
  .attr('fill', "purple")

const yAxisElement = inner
  .append("g")
  .attr("class", "y axis")
  .attr("transform", `translate(${margin.left},0)`)
  .call(yAxis)

// Calculate a zoom
function zoom(start, end) {
  const zoomX = X.slice(start, end);
  const zoomY = Y.slice(start, end);
  console.log("zoomX", zoomX)
  const ratio = X.length / zoomX.length;
  const offset = start / X.length;
  
  const zoomWidth = innerWidth * ratio;
  console.log(zoomWidth)
  const zoomLeft = zoomWidth * offset;
  
  const xScaleZoom = d3.scaleUtc(d3.extent(X), [margin.left - zoomLeft, margin.left - zoomLeft + zoomWidth])
  
  const xAxisZoom = d3.axisBottom(xScaleZoom)
  
  DURATION = 1000;
  
  xAxisElement.transition()
    .duration(DURATION)
    .call(xAxisZoom)
  
  const zoomBandWidth = width / (zoomX.length);
  
  // Re-calculate Y
  const yScaleZoom = d3.scaleLinear([0, d3.max(zoomY)], [margin.top + innerHeight, margin.top]);
  
  yAxisElement.transition()
      .duration(DURATION)
      .call(d3.axisLeft(yScaleZoom));
  
  bars.transition()
    .duration(DURATION)
    .attr('x', (d, i) => xScaleZoom(d) - zoomBandWidth * .45)
    .attr('width', (d,i) => zoomBandWidth * 0.9)
    .attr('y', (d, i) => margin.top + yScaleZoom(Y[i]))
    .attr('height', (d, i) => innerHeight - yScaleZoom(Y[i]))

}

d3.select("#zoom").on("click", () => {
  console.log("ZOOM")
  zoom(25, 30);
});

d3.select("#original").on("click", () => {
  zoom(0, X.length);
});
