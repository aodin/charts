var charts=(()=>{var V=Object.create;var I=Object.defineProperty;var H=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var B=Object.getPrototypeOf,z=Object.prototype.hasOwnProperty;var $=(e,t,i)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),q=(e,t)=>{for(var i in t)I(e,i,{get:t[i],enumerable:!0})},N=(e,t,i,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let h of W(t))!z.call(e,h)&&h!==i&&I(e,h,{get:()=>t[h],enumerable:!(n=H(t,h))||n.enumerable});return e};var T=(e,t,i)=>(i=e!=null?V(B(e)):{},N(t||!e||!e.__esModule?I(i,"default",{value:e,enumerable:!0}):i,e)),J=e=>N(I({},"__esModule",{value:!0}),e);var F=(e,t,i)=>$(e,typeof t!="symbol"?t+"":t,i);var x=j((rt,A)=>{A.exports=d3});var it={};q(it,{OHLCV:()=>O});var s=T(x());var p=T(x());function R(e,{ratio:t=.2,maxWidth:i=1600,minWidth:n=400,minHeight:h=300}={}){let o=document.querySelector(e),m=p.min([o.offsetWidth,i]);m=p.max([o.offsetWidth,n]);let g=p.max([parseInt(t*m),h]);return[m,g]}function b(e,t,i,n,h){let o=p.select("body").append("svg").attr("width",100).attr("height",t).style("visibility","hidden"),m=p.scaleLinear().domain(i).range([t-e.bottom,e.top]),g=p.axisLeft(m).tickFormat(n).tickSize(0).ticks(8),l=o.append("g").style("font-size",h.FONT_SIZE).call(g).selectAll(".tick text"),c=0;return l.each(function(){let y=this.getBoundingClientRect();y.width>c&&(c=y.width)}),c+h.X_TICK_GUTTER+5}var a=T(x());var X=T(x()),Y=class{constructor(t={}){this.ANIMATION_DURATION_MS=500,this.X_TICK_SIZE=4,this.X_TICK_GUTTER=3,this.Y_TICK_SIZE=0,this.Y_TICK_GUTTER=5,this.FONT_SIZE="13px",this.COLORS=X.schemeCategory10,this.BAND_PADDING=.2,this.VOLUME_OPACITY=.6,this.OHLC_COLORS=["#1ebc8c","#b2b2b2","#f34d27"],this.STROKE_WIDTH=1.5,this.HIGHLIGHT_STROKE_WIDTH=2,this.BACKGROUND_OPACITY=.3,this.DOT_RADIUS=3,this.BAR_STROKE_WIDTH=0,this.EVENT_FPS=48,Object.assign(this,t)}get eventLatency(){return parseInt(1e3/this.EVENT_FPS)}};var _=class{constructor(t,i={}){F(this,"tickFormatX",null);F(this,"tickFormatY",null);this.options=new Y(i),this.data=t,this.parse(t)}getMargin(t,i){return{top:15,right:15,bottom:25,left:45}}getTickValuesX(){return null}getTickValuesY(){return null}parse(t){this.X=this.parseX(t),this.Y=this.parseY(t),this.Z=this.parseZ(t),this.items=new Set(this.Z);let i=(n,h)=>!isNaN(this.X[h])&&!isNaN(this.Y[h]);this.D=a.map(t,i),this.I=a.range(this.X.length),this.grouping=a.group(this.I,n=>this.Z[n]),this.setColors(t)}formatX(t){return t}formatY(t){return t}formatZ(t){return t}parseX(t){return a.map(t,i=>a.isoParse(i[0]))}parseY(t){return a.map(t,i=>i[1])}parseZ(t){return a.map(t,i=>i[2])}getDomainX(){return a.extent(this.X)}getRangeX(t,i){return[i.left,t.width-i.right]}getDomainY(){return a.extent(this.Y)}getRangeY(t,i){return[t.height-i.bottom,i.top]}setColors(t){this.colors=a.scaleOrdinal().domain(this.items).range(this.options.COLORS)}getColor(t){return this.colors(t)}getDimensions(t){return R(t,{ratio:.35})}createSVG(t,i){a.select(t).selectAll("svg").remove(),this.svg=a.select(t).append("svg").attr("viewBox",[0,0,i.width,i.height]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("font-size",this.options.FONT_SIZE).style("overflow","visible")}clear(){this.svg&&this.svg.selectAll("*").remove()}};var f=T(x()),mt=f.utcFormat("%b"),Q=f.utcFormat("%b %-d"),pt=f.utcFormat("%b %Y"),tt=f.utcFormat("%b %-d, %Y"),dt=f.utcFormat("%B %-d, %Y");function w(){let e=null;return function(t){let i=t.getUTCFullYear();return e!==i?(e=i,tt(t)):Q(t)}}function E(e,t){var i=!0;return function(){i&&(e.apply(this,arguments),i=!1,setTimeout(()=>{i=!0},t))}}var xt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}),ft=new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),It=new Intl.NumberFormat("en-US",{maximumSignificantDigits:3}),Tt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}),yt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:0,signDisplay:"exceptZero"}),Dt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:2,maximumFractionDigits:3}),v=function(e){if(e)return e>=1e9?`${e/1e9}B`:`${e/1e6}M`};var O=class extends _{parse(t){this.X=s.map(t,i=>s.isoParse(i[0])),this.Yo=s.map(t,i=>i[1]),this.Yh=s.map(t,i=>i[2]),this.Yl=s.map(t,i=>i[3]),this.Yc=s.map(t,i=>i[4]),this.Yv=s.map(t,i=>i[5]),this.I=s.range(this.X.length)}getMargin(t,i){let n={top:15,right:25,bottom:25,left:40};return n.left=b(n,i,this.getDomainY(),this.tickFormatY,this.options),n.right=b(n,i,this.yDomainVolume,v,this.options),n}getDomainX(){return s.extent(this.X)}getDomainY(){this.minPrice=s.min(this.Yl);let t=s.max(this.Yh);return this.yDomain=[this.minPrice,t+(t-this.minPrice)*.05],this.yDomainVolume=[0,s.max(this.Yv)],this.yDomain}getColor(t){return this.options.OHLC_COLORS[1+Math.sign(this.Yo[t]-this.Yc[t])]}render(t){let[i,n]=this.getDimensions(t),h={width:i,height:n},o=this.getMargin(i,n),m=n-o.top-o.bottom;this.chartHeight=m;let u=m*.9,l=[o.top+u,o.top],c=[o.top+m,o.top+u],y=",f",k="",S=parseInt(this.X.length/10);S<1&&(S=1);let U=s.filter(this.X,(r,K)=>K%S===0);this.xScale=s.scaleBand(this.X,this.getRangeX(h,o)).padding(this.options.BAND_PADDING).align(.1);let d=s.scaleLinear(this.getDomainY(),l),D=s.scaleLinear(this.yDomainVolume,c),P=w(),L=s.axisBottom(this.xScale).tickFormat(P).tickValues(U).tickSize(this.options.X_TICK_SIZE);this.bandWidth=this.xScale.step();let M=s.axisLeft(d).ticks(u/40,y).tickSize(this.options.Y_TICK_SIZE),Z=s.axisRight(D).ticks(1).tickFormat(v).tickSize(3);this.createSVG(t,h);let G=this.bandWidth*this.options.BAND_PADDING/2;this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${G},${n-o.bottom+this.options.X_TICK_GUTTER})`).call(L).call(r=>r.select(".domain").remove()),this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${o.left-this.options.Y_TICK_GUTTER},0)`).call(M).call(r=>r.select(".domain").remove()).call(r=>r.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",this.options.Y_TICK_GUTTER).attr("x2",i+this.options.Y_TICK_GUTTER-o.left-o.right)).call(r=>r.append("text").attr("x",-o.left).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(k)),this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${i-o.right},0)`).call(Z).call(r=>r.select(".domain").remove()).call(r=>r.append("text").attr("x",-o.left).attr("fill","currentColor").attr("text-anchor","start").text(k));let C=this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",r=>`translate(${this.xScale(this.X[r])+this.bandWidth/2},0)`);C.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("opacity",.8).attr("y1",d(this.minPrice)).attr("y2",d(this.minPrice)).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y1",r=>d(this.Yl[r])).attr("y2",r=>d(this.Yh[r])),C.append("line").attr("stroke-width",this.xScale.bandwidth()).attr("stroke",r=>this.getColor(r)).attr("y1",d(this.minPrice)).attr("y2",d(this.minPrice)).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y1",r=>d(this.Yo[r])).attr("y2",r=>d(this.Yc[r])),this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",r=>`translate(${this.xScale(this.X[r])+this.bandWidth/2},0)`).append("line").attr("y1",D(0)).attr("y2",D(0)).attr("stroke-width",this.xScale.bandwidth()).attr("stroke",r=>this.getColor(r)).style("opacity",this.options.VOLUME_OPACITY).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y2",r=>D(this.Yv[r]))}enableHover(t,i){let n=s.map(this.X,g=>[this.xScale(g)+this.bandWidth/2,1]),h=s.Delaunay.from(n),o=null,m=g=>{let[u]=s.pointer(g),l=h.find(u,1);if(o&&o==l)return;o=l;let c={x:this.X[l],o:this.Yo[l],h:this.Yh[l],l:this.Yl[l],c:this.Yc[l],v:this.Yv[l]};l>0&&(c.prev=this.Yc[l-1],c.prev&&(c.delta=c.c-c.prev,c.percent=c.delta/c.prev,c.color=this.options.OHLC_COLORS[1+Math.sign(-c.delta)])),t&&t.call(this,c)};this.svg.on("pointermove",E(m,this.options.eventLatency)),i&&this.svg.on("pointerleave",i)}};return J(it);})();
//# sourceMappingURL=ohlcv.min.js.map
