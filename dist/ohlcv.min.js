var charts=(()=>{var W=Object.create;var _=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var B=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,$=Object.prototype.hasOwnProperty;var z=(e,t,i)=>t in e?_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var q=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),j=(e,t)=>{for(var i in t)_(e,i,{get:t[i],enumerable:!0})},N=(e,t,i,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let h of B(t))!$.call(e,h)&&h!==i&&_(e,h,{get:()=>t[h],enumerable:!(a=G(t,h))||a.enumerable});return e};var f=(e,t,i)=>(i=e!=null?W(V(e)):{},N(t||!e||!e.__esModule?_(i,"default",{value:e,enumerable:!0}):i,e)),Q=e=>N(_({},"__esModule",{value:!0}),e);var D=(e,t,i)=>z(e,typeof t!="symbol"?t+"":t,i);var g=q((ot,v)=>{v.exports=d3});var et={};j(et,{OHLCV:()=>b});var s=f(g());var m=f(g()),u=class{constructor(t,i,a,h){this.top=t,this.right=i,this.bottom=a,this.left=h}},X=class{constructor(t,i,a){this.width=t,this.height=i,this.padding=a}get rangeX(){return[this.padding.left,this.width-this.padding.right]}get rangeY(){return[this.height-this.padding.bottom,this.padding.top]}get innerWidth(){return this.width-this.padding.left-this.padding.right}get innerHeight(){return this.height-this.padding.top-this.padding.bottom}};function w(){return new X(window.innerWidth,window.innerHeight,new u(15,15,15,15))}function O(e,t,i,a,h){let p=m.select("body").append("svg").attr("width",100).attr("height",t).style("visibility","hidden"),y=m.scaleLinear().domain(i).range([t-e.bottom,e.top]),c=m.axisLeft(y).tickFormat(a).tickSize(0).ticks(8),l=p.append("g").style("font-size",h.FONT_SIZE).call(c).selectAll(".tick text"),o=0;return l.each(function(){let I=this.getBoundingClientRect();I.width>o&&(o=I.width)}),p.remove(),o+h.X_TICK_GUTTER+5}var r=f(g());var F=f(g()),Y=class{constructor(t={}){this.ANIMATION_DURATION_MS=500,this.X_TICK_MAX_COUNT=null,this.X_TICK_SPACE=50,this.X_TICK_SIZE=4,this.X_TICK_GUTTER=3,this.Y_TICK_MAX_COUNT=null,this.Y_TICK_SPACE=40,this.Y_TICK_SIZE=0,this.Y_TICK_GUTTER=5,this.FONT_SIZE="13px",this.COLORS=F.schemeCategory10,this.BAND_PADDING=.2,this.VOLUME_OPACITY=.6,this.OHLC_COLORS=["#1ebc8c","#b2b2b2","#f34d27"],this.STROKE_WIDTH=1.5,this.HIGHLIGHT_STROKE_WIDTH=2,this.BACKGROUND_OPACITY=.3,this.DOT_RADIUS=3,this.BAR_STROKE_WIDTH=0,this.EVENT_FPS=48,Object.assign(this,t)}get eventLatency(){return parseInt(1e3/this.EVENT_FPS)}getYTickCount(t){let i=parseInt(t/this.Y_TICK_SPACE)+1;return this.Y_TICK_MAX_COUNT&&i>this.Y_TICK_MAX_COUNT&&(i=this.Y_TICK_MAX_COUNT),i}getXTickCount(t){let i=parseInt(t/this.X_TICK_SPACE)+1;return this.X_TICK_MAX_COUNT&&i>this.X_TICK_MAX_COUNT&&(i=this.X_TICK_MAX_COUNT),i}};var S=class{constructor(t,i={}){D(this,"tickFormatX",null);D(this,"tickFormatY",null);this.options=new Y(i),this.data=t,this.parse(t)}getPadding(t){return new u(15,15,15,30)}getTickValuesX(){return null}getTickValuesY(){return null}parse(t){this.X=this.parseX(t),this.Y=this.parseY(t),this.Z=this.parseZ(t),this.items=new Set(this.Z);let i=(a,h)=>!isNaN(this.X[h])&&!isNaN(this.Y[h]);this.D=r.map(t,i),this.I=r.range(this.X.length),this.grouping=r.group(this.I,a=>this.Z[a]),this.setColors(t)}formatX(t){return t}formatY(t){return t}formatZ(t){return t}parseX(t){return r.map(t,i=>r.isoParse(i[0]))}parseY(t){return r.map(t,i=>i[1])}parseZ(t){return r.map(t,i=>i[2])}getDomainX(){return r.extent(this.X)}getRangeX(t){return t.rangeX}getDomainY(){return r.extent(this.Y)}getRangeY(t){return t.rangeY}setColors(t){this.colors=r.scaleOrdinal().domain(this.items).range(this.options.COLORS)}getColor(t){return this.colors(t)}getLayout(t){let i=w();return i.height=parseInt(i.height*.7),i}createSVG(t,i){r.select(t).selectAll("svg").remove(),this.svg=r.select(t).append("svg").attr("viewBox",[0,0,i.width,i.height]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("font-size",this.options.FONT_SIZE).style("overflow","visible")}clear(){this.svg&&this.svg.selectAll("*").remove()}};var T=f(g()),pt=T.utcFormat("%b"),J=T.utcFormat("%b %-d"),mt=T.utcFormat("%b %Y"),tt=T.utcFormat("%b %-d, %Y"),gt=T.utcFormat("%B %-d, %Y");function U(){let e=null;return function(t){let i=t.getUTCFullYear();return e!==i?(e=i,tt(t)):J(t)}}function E(e,t){var i=!0;return function(){i&&(e.apply(this,arguments),i=!1,setTimeout(()=>{i=!0},t))}}var R=f(g()),ft=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,Tt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,_t=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,it=R.format(",.0f"),A=function(e){if(e)return e>=1e9?`${e/1e9}B`:e>=1e6?`${e/1e6}M`:it(e)};var b=class extends S{parse(t){this.X=s.map(t,i=>s.isoParse(i[0])),this.Yo=s.map(t,i=>i[1]),this.Yh=s.map(t,i=>i[2]),this.Yl=s.map(t,i=>i[3]),this.Yc=s.map(t,i=>i[4]),this.Yv=s.map(t,i=>i[5]),this.I=s.range(this.X.length)}getPadding(t){let i=new u(15,25,25,40);return i.left=O(i,this.layout.height,this.getDomainY(),this.tickFormatY,this.options),i.right=O(i,this.layout.height,this.yDomainVolume,A,this.options),i}getDomainX(){return s.extent(this.X)}getDomainY(){this.minPrice=s.min(this.Yl);let t=s.max(this.Yh);return this.yDomain=[this.minPrice,t+(t-this.minPrice)*.05],this.yDomainVolume=[0,s.max(this.Yv)],this.yDomain}getColor(t){return this.options.OHLC_COLORS[1+Math.sign(this.Yo[t]-this.Yc[t])]}render(t){this.layout=this.getLayout(t),this.layout.padding=this.getPadding(this.layout);let a=this.layout.innerHeight*.9,h=[this.layout.padding.top+a,this.layout.padding.top],p=[this.layout.padding.top+this.layout.innerHeight,this.layout.padding.top+a],y="",c=this.getRangeX(this.layout),x=c[1]-c[0],l=this.options.getXTickCount(x),o=parseInt(this.X.length/l);o<1&&(o=1);let I=s.filter(this.X,(n,Z)=>Z%o===0);this.xScale=s.scaleBand(this.X,c).padding(this.options.BAND_PADDING).align(.1);let d=s.scaleLinear(this.getDomainY(),h),C=s.scaleLinear(this.yDomainVolume,p),P=U(),K=s.axisBottom(this.xScale).tickFormat(P).tickValues(I).tickSize(this.options.X_TICK_SIZE);this.bandWidth=this.xScale.step();let M=s.axisLeft(d).ticks(this.options.getYTickCount(a)).tickSize(this.options.Y_TICK_SIZE),L=s.axisRight(C).ticks(1).tickFormat(A).tickSize(3);this.createSVG(t,this.layout);let H=this.bandWidth*this.options.BAND_PADDING/2;this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${H},${this.layout.height-this.layout.padding.bottom+this.options.X_TICK_GUTTER})`).call(K).call(n=>n.select(".domain").remove()),this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${this.layout.padding.left-this.options.Y_TICK_GUTTER},0)`).call(M).call(n=>n.select(".domain").remove()).call(n=>n.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",this.options.Y_TICK_GUTTER).attr("x2",this.layout.width+this.options.Y_TICK_GUTTER-this.layout.padding.left-this.layout.padding.right)).call(n=>n.append("text").attr("x",-this.layout.padding.left).attr("y",10).attr("fill","currentColor").attr("text-anchor","start").text(y)),this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${this.layout.width-this.layout.padding.right},0)`).call(L).call(n=>n.select(".domain").remove()).call(n=>n.append("text").attr("x",-this.layout.padding.left).attr("fill","currentColor").attr("text-anchor","start").text(y));let k=this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",n=>`translate(${this.xScale(this.X[n])+this.bandWidth/2},0)`);k.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("opacity",.8).attr("y1",d(this.minPrice)).attr("y2",d(this.minPrice)).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y1",n=>d(this.Yl[n])).attr("y2",n=>d(this.Yh[n])),k.append("line").attr("stroke-width",this.xScale.bandwidth()).attr("stroke",n=>this.getColor(n)).attr("y1",d(this.minPrice)).attr("y2",d(this.minPrice)).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y1",n=>d(this.Yo[n])).attr("y2",n=>d(this.Yc[n])),this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",n=>`translate(${this.xScale(this.X[n])+this.bandWidth/2},0)`).append("line").attr("y1",C(0)).attr("y2",C(0)).attr("stroke-width",this.xScale.bandwidth()).attr("stroke",n=>this.getColor(n)).style("opacity",this.options.VOLUME_OPACITY).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y2",n=>C(this.Yv[n])),this.tooltip=this.svg.append("g").lower().attr("class","tooltip").append("rect").attr("fill","#bbb").style("display","none").style("opacity",.2).style("pointer-events","none")}highlight(t){this.tooltip.attr("x",this.xScale(this.X[t])).attr("width",this.bandWidth).attr("y",this.layout.padding.top).attr("height",this.layout.innerHeight).style("display","block")}noHighlight(){this.tooltip.style("display","none")}enableHover(t,i){let a=s.map(this.X,c=>[this.xScale(c)+this.bandWidth/2,1]),h=s.Delaunay.from(a),p=null,y=c=>{let[x]=s.pointer(c),l=h.find(x,1);if(p&&p==l)return;p=l;let o={i:l,x:this.X[l],o:this.Yo[l],h:this.Yh[l],l:this.Yl[l],c:this.Yc[l],v:this.Yv[l]};l>0&&(o.prev=this.Yc[l-1],o.prev&&(o.delta=o.c-o.prev,o.percent=o.delta/o.prev,o.color=this.options.OHLC_COLORS[1+Math.sign(-o.delta)])),t&&t.call(this,o)};this.svg.on("pointermove",E(y,this.options.eventLatency)),i&&this.svg.on("pointerleave",i)}};return Q(et);})();
//# sourceMappingURL=ohlcv.min.js.map
