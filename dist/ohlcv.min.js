var charts=(()=>{var V=Object.create;var C=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var Z=Object.getPrototypeOf,W=Object.prototype.hasOwnProperty;var B=(s,t,i)=>t in s?C(s,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):s[t]=i;var $=(s,t)=>()=>(t||s((t={exports:{}}).exports,t),t.exports),z=(s,t)=>{for(var i in t)C(s,i,{get:t[i],enumerable:!0})},N=(s,t,i,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of P(t))!W.call(s,n)&&n!==i&&C(s,n,{get:()=>t[n],enumerable:!(o=G(t,n))||o.enumerable});return s};var T=(s,t,i)=>(i=s!=null?V(Z(s)):{},N(t||!s||!s.__esModule?C(i,"default",{value:s,enumerable:!0}):i,s)),q=s=>N(C({},"__esModule",{value:!0}),s);var E=(s,t,i)=>B(s,typeof t!="symbol"?t+"":t,i);var u=$((nt,k)=>{k.exports=d3});var st={};z(st,{CandlestickChart:()=>O,OHLC:()=>tt,OHLCV:()=>it});var e=T(u());var p=T(u()),y=class{constructor(t,i,o,n){this.top=t,this.right=i,this.bottom=o,this.left=n}},R=class{constructor(t,i,o){this.width=t,this.height=i,this.padding=o}get rangeX(){return[this.padding.left,this.width-this.padding.right]}get rangeY(){return[this.height-this.padding.bottom,this.padding.top]}get innerWidth(){return this.width-this.padding.left-this.padding.right}get innerHeight(){return this.height-this.padding.top-this.padding.bottom}get innerMinimum(){return p.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function X(s,{minWidth:t=400,maxWidth:i=void 0,minHeight:o=300,maxHeight:n=void 0,screenHeightFraction:g=.5}={}){let m=document.querySelector(s),a=p.max([m.offsetWidth,t]);i&&(a=p.min([a,i]));let d=window.innerHeight*g;return d=p.max([d,o]),n&&(d=p.min([d,n])),new R(a,d,new y(15,15,25,25))}function Y(s,t,i,o,n){let g=p.select("body").append("svg").attr("width",100).attr("height",t).style("visibility","hidden"),m=p.scaleLinear().domain(i).range([t-s.bottom,s.top]),a=p.axisLeft(m).tickFormat(o).tickSize(0).ticks(8),f=g.append("g").style("font-size",n.FONT_SIZE).call(a).selectAll(".tick text"),l=0;return f.each(function(){let c=this.getBoundingClientRect();c.width>l&&(l=c.width)}),g.remove(),l+n.X_TICK_GUTTER+5}var r=T(u());var U=T(u()),S=class{constructor(t={}){this.ANIMATION_DURATION_MS=500,this.SCREEN_HEIGHT_FRACTION=.65,this.X_TICK_MAX_COUNT=null,this.X_TICK_SPACE=50,this.X_TICK_SIZE=4,this.X_TICK_GUTTER=3,this.Y_TICK_MAX_COUNT=null,this.Y_TICK_SPACE=40,this.Y_TICK_SIZE=0,this.Y_TICK_GUTTER=5,this.FONT_SIZE="13px",this.COLORS=U.schemeCategory10,this.MIN_Y_AT_ZERO=!1,this.Y_TICKS_RIGHT=!1,this.BAND_PADDING=.2,this.VOLUME_OPACITY=.6,this.OHLC_COLORS=["#1ebc8c","#b2b2b2","#f34d27"],this.VOLUME_COLORS=["#1ebc8c","#b2b2b2","#f34d27"],this.HIDE_VOLUME=!1,this.HIDE_VOLUME_TICKS=!1,this.STROKE_WIDTH=1.5,this.HIGHLIGHT_STROKE_WIDTH=2,this.BACKGROUND_OPACITY=.3,this.DOT_RADIUS=3,this.BAR_STROKE_WIDTH=0,this.INNER_RADIUS=.3,this.OUTER_RADIUS=.8,this.INNER_RADIUS_HOVER=.3,this.OUTER_RADIUS_HOVER=.9,this.EVENT_FPS=48,Object.assign(this,t)}get eventLatency(){return parseInt(1e3/this.EVENT_FPS)}get showVolumeTicks(){return!(this.HIDE_VOLUME||this.HIDE_VOLUME_TICKS)}getYTickCount(t){let i=parseInt(t/this.Y_TICK_SPACE)+1;return this.Y_TICK_MAX_COUNT&&i>this.Y_TICK_MAX_COUNT&&(i=this.Y_TICK_MAX_COUNT),i}getXTickCount(t){let i=parseInt(t/this.X_TICK_SPACE)+1;return this.X_TICK_MAX_COUNT&&i>this.X_TICK_MAX_COUNT&&(i=this.X_TICK_MAX_COUNT),i}};var x=class{constructor(t,i={}){E(this,"tickFormatX",null);E(this,"tickFormatY",null);this.options=new S(i),this.data=t,this.parse(t)}screenHeightRatio(t){return this.options.SCREEN_HEIGHT_FRACTION=t,this}minAtZero(){return this.options.MIN_Y_AT_ZERO=!0,this}colorSet(t){return this.options.COLORS=t,this.setColors(),this}yTicksRight(){return this.options.Y_TICKS_RIGHT=!0,this}yTickLimit(t){return this.options.Y_TICK_MAX_COUNT=t,this}getTickValuesX(){return null}getTickValuesY(){return null}parse(t){this.X=this.parseX(t),this.Y=this.parseY(t),this.Z=this.parseZ(t),this.items=new Set(this.Z);let i=(o,n)=>!isNaN(this.X[n])&&!isNaN(this.Y[n]);this.D=r.map(t,i),this.I=r.range(this.X.length),this.grouping=r.group(this.I,o=>this.Z[o]),this.setColors(t)}formatX(t){return t}formatY(t){return t}formatZ(t){return t}parseX(t){return r.map(t,i=>r.isoParse(i[0]))}parseY(t){return r.map(t,i=>i[1])}parseZ(t){return r.map(t,i=>i[2])}getDomainX(){return r.extent(this.X)}getRangeX(t){return t.rangeX}getDomainY(){return this.options.MIN_Y_AT_ZERO?[0,r.max(this.Y)]:r.extent(this.Y)}getRangeY(t){return t.rangeY}setColors(t){this.colors=r.scaleOrdinal().domain(this.items).range(this.options.COLORS)}getColor(t){return this.colors(t)}getLayout(t){return X(t,{screenHeightFraction:this.options.SCREEN_HEIGHT_FRACTION})}getPadding(t){let i=Y(t.padding,t.height,this.getDomainY(),this.tickFormatY,this.options);return this.options.Y_TICKS_RIGHT?t.padding.right=i:t.padding.left=i,t.padding}createSVG(t,i){r.select(t).selectAll("svg").remove(),this.svg=r.select(t).append("svg").attr("viewBox",[0,0,i.width,i.height]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("font-size",this.options.FONT_SIZE).style("overflow","visible")}clear(){this.svg&&this.svg.selectAll("*").remove()}};var I=T(u()),dt=I.utcFormat("%b"),j=I.utcFormat("%b %-d"),pt=I.utcFormat("%b %Y"),Q=I.utcFormat("%b %-d, %Y"),gt=I.utcFormat("%B %-d, %Y");function b(){let s=null;return function(t){let i=t.getUTCFullYear();return s!==i?(s=i,Q(t)):j(t)}}function H(s,t){var i=!0;return function(){i&&(s.apply(this,arguments),i=!1,setTimeout(()=>{i=!0},t))}}var v=T(u()),_t=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,Tt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,It=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,J=v.format(",.0f"),A=function(s){if(s)return s>=1e9?`${s/1e9}B`:s>=1e6?`${s/1e6}M`:J(s)};var O=class extends x{parse(t){this.X=e.map(t,i=>e.isoParse(i[0])),this.Yo=e.map(t,i=>i[1]),this.Yh=e.map(t,i=>i[2]),this.Yl=e.map(t,i=>i[3]),this.Yc=e.map(t,i=>i[4]),this.Yv=e.map(t,i=>i[5]),this.I=e.range(this.X.length)}getPadding(t){let i=new y(15,25,25,40),o=Y(i,this.layout.height,this.getDomainY(),this.tickFormatY,this.options),n=0;return this.options.showVolumeTicks&&(n=Y(i,this.layout.height,this.yDomainVolume,A,this.options)),this.options.Y_TICKS_RIGHT?i.right=e.max([o,n,i.right]):(i.left=e.max([o,i.left]),i.right=e.max([n,i.right])),i}noAnimation(){return this.options.ANIMATION_DURATION_MS=0,this}volumeColorSet(t){return this.options.VOLUME_COLORS=t,this}hideVolume(){return this.options.HIDE_VOLUME=!0,this}hideVolumeTicks(){return this.options.HIDE_VOLUME_TICKS=!0,this}getDomainX(){return e.extent(this.X)}getDomainY(){this.minPrice=this.options.MIN_Y_AT_ZERO?0:e.min(this.Yl);let t=e.max(this.Yh);return this.yDomain=[this.minPrice,t+(t-this.minPrice)*.05],this.yDomainVolume=[0,e.max(this.Yv)],this.yDomain}getColor(t){return this.options.OHLC_COLORS[1+Math.sign(this.Yo[t]-this.Yc[t])]}getVolumeColor(t){return this.options.VOLUME_COLORS[1+Math.sign(this.Yo[t]-this.Yc[t])]}getXTicks(){let t=this.options.getXTickCount(this.layout.innerWidth),i=parseInt(this.X.length/t);return i<1&&(i=1),e.filter(this.X,(o,n)=>n%i===0)}render(t,i){this.layout=this.getLayout(t),this.layout.padding=this.getPadding(this.layout);let o=this.options.HIDE_VOLUME?1:.9,n=this.layout.innerHeight*o,g=[this.layout.padding.top+n,this.layout.padding.top],m=[this.layout.padding.top+this.layout.innerHeight,this.layout.padding.top+n];this.xScale=e.scaleBand(this.X,this.getRangeX(this.layout)).padding(this.options.BAND_PADDING).align(.1);let a=i?e.scaleLog(this.getDomainY(),g).clamp(!0):e.scaleLinear(this.getDomainY(),g).clamp(!0),d=e.scaleLinear(this.yDomainVolume,m).clamp(!0),f=b(),l=e.axisBottom(this.xScale).tickFormat(f).tickValues(this.getXTicks()).tickSize(this.options.X_TICK_SIZE);this.bandWidth=this.xScale.step();let c=this.options.Y_TICKS_RIGHT?e.axisRight(a):e.axisLeft(a);c.ticks(this.options.getYTickCount(n),this.tickFormatY).tickSize(this.options.Y_TICK_SIZE);let M=e.axisRight(d).ticks(1).tickFormat(A).tickSize(3);this.createSVG(t,this.layout);let F=this.bandWidth*this.options.BAND_PADDING/2;this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${F},${this.layout.height-this.layout.padding.bottom+this.options.X_TICK_GUTTER})`).call(l).call(h=>h.select(".domain").remove());let L=this.options.Y_TICKS_RIGHT?this.layout.width-this.layout.padding.right:this.layout.padding.left-this.options.Y_TICK_GUTTER,K=this.options.Y_TICKS_RIGHT?-this.options.Y_TICK_GUTTER:this.options.Y_TICK_GUTTER,w=this.options.Y_TICKS_RIGHT?-this.layout.innerWidth:this.layout.innerWidth+this.options.Y_TICK_GUTTER;this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${L},0)`).call(c).call(h=>h.select(".domain").remove()).call(h=>h.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",K).attr("x2",w)),this.options.showVolumeTicks&&this.svg.append("g").style("font-size",this.options.FONT_SIZE).attr("transform",`translate(${this.layout.width-this.layout.padding.right},0)`).call(M).call(h=>h.select(".domain").remove());let D=this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",h=>`translate(${this.xScale(this.X[h])+this.bandWidth/2},0)`);D.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("opacity",.8).attr("y1",a(this.minPrice)).attr("y2",a(this.minPrice)).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y1",h=>a(this.Yl[h])).attr("y2",h=>a(this.Yh[h])),D.append("line").attr("stroke-width",this.xScale.bandwidth()).attr("stroke",h=>this.getColor(h)).attr("y1",a(this.minPrice)).attr("y2",a(this.minPrice)).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y1",h=>a(this.Yo[h])).attr("y2",h=>a(this.Yc[h])),this.options.HIDE_VOLUME||this.svg.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.I).join("g").attr("transform",_=>`translate(${this.xScale(this.X[_])+this.bandWidth/2},0)`).append("line").attr("y1",d(0)).attr("y2",d(0)).attr("stroke-width",this.xScale.bandwidth()).attr("stroke",_=>this.getVolumeColor(_)).style("opacity",this.options.VOLUME_OPACITY).transition().duration(this.options.ANIMATION_DURATION_MS).attr("y2",_=>d(this.Yv[_]?this.Yv[_]:0)),this.highlightBand=this.svg.append("g").lower().attr("class","highlight").append("rect").attr("fill","#bbb").style("display","none").style("opacity",.2).style("pointer-events","none")}renderLog(t){return this.render(t,!0)}renderLinear(t){return this.render(t,!1)}highlight(t){this.highlightBand.attr("x",this.xScale(this.X[t])).attr("width",this.bandWidth).attr("y",this.layout.padding.top).attr("height",this.layout.innerHeight).style("display","block")}noHighlight(){this.highlightBand.style("display","none")}enableHover(t,i){let o=e.map(this.X,d=>[this.xScale(d)+this.bandWidth/2,1]),n=e.Delaunay.from(o),g=null,m=d=>{let[f]=e.pointer(d),l=n.find(f,1);if(g&&g==l)return;g=l;let c={i:l,x:this.X[l],o:this.Yo[l],h:this.Yh[l],l:this.Yl[l],c:this.Yc[l],v:this.Yv[l]};l>0&&(c.prev=this.Yc[l-1],c.prev&&(c.delta=c.c-c.prev,c.percent=c.delta/c.prev,c.color=this.options.OHLC_COLORS[1+Math.sign(-c.delta)])),t&&t.call(this,c)},a=d=>{g=null,i&&i.call(this)};this.svg.on("pointermove",H(m,this.options.eventLatency)).on("pointerleave",a)}};function tt(s,t){return new O(s,t).hideVolume()}function it(s,t){return new O(s,t)}return q(st);})();
//# sourceMappingURL=ohlcv.min.js.map
