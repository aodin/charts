var charts=(()=>{var Z=Object.create;var I=Object.defineProperty;var j=Object.getOwnPropertyDescriptor;var Q=Object.getOwnPropertyNames;var J=Object.getPrototypeOf,tt=Object.prototype.hasOwnProperty;var it=(t,e,i)=>e in t?I(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i;var et=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),st=(t,e)=>{for(var i in e)I(t,i,{get:e[i],enumerable:!0})},D=(t,e,i,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Q(e))!tt.call(t,s)&&s!==i&&I(t,s,{get:()=>e[s],enumerable:!(n=j(e,s))||n.enumerable});return t};var m=(t,e,i)=>(i=t!=null?Z(J(t)):{},D(e||!t||!t.__esModule?I(i,"default",{value:t,enumerable:!0}):i,t)),nt=t=>D(I({},"__esModule",{value:!0}),t);var H=(t,e,i)=>it(t,typeof e!="symbol"?e+"":e,i);var p=et((At,N)=>{N.exports=d3});var mt={};st(mt,{CandlestickChart:()=>_,OHLC:()=>gt,OHLCV:()=>pt,parseArrayOHLCV:()=>G,parseVerboseOHLCV:()=>U});var a=m(p());var Y=m(p());var rt=m(p());var T=class{constructor(e,i=n=>n){}screenHeightPercent(e){return this.config.SCREEN_HEIGHT_PERCENT=e,this}animationDuration(e){return this.config.DURATION_MS=e,this}noAnimation(){return this.animationDuration(0)}};var M=m(p()),Rt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,bt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,Lt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,at=M.format(",.0f"),b=function(t){if(t)return t>=1e9?`${t/1e9}B`:t>=1e6?`${t/1e6}M`:at(t)};var g=m(p()),L=class{constructor(e,i,n,s){this.top=e,this.right=i,this.bottom=n,this.left=s}};function C(){return new L(15,15,25,25)}var w=class{constructor(e,i,n){this.width=e,this.height=i,this.pad=n||C()}get rangeX(){return[this.pad.left,this.width-this.pad.right]}get rangeY(){return[this.height-this.pad.bottom,this.pad.top]}get innerWidth(){return this.width-this.pad.left-this.pad.right}get innerHeight(){return this.height-this.pad.top-this.pad.bottom}get innerMinimum(){return g.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function F(t,{minWidth:e=400,maxWidth:i=void 0,minHeight:n=300,maxHeight:s=void 0,screenHeightPercent:o=.5}={}){let h=document.querySelector(t),r=g.max([h.offsetWidth,e]);i&&(r=g.min([r,i]));let l=window.innerHeight*o;return l=g.max([l,n]),s&&(l=g.min([l,s])),new w(r,l,C())}function ot(t,e,i){return g.select(t).append("svg").attr("viewBox",[0,0,e,i]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("overflow","visible")}function V(t,e){let i=g.select(t);if(!i.node())throw new Error(`Unable to find a DOM element for selector '${t}'`);if(i.node().tagName==="svg"){let o=i,h=+o.attr("width"),r=+o.attr("height");if(h&&r)return[o,new w(h,r)];{let l=F(t,{screenHeightPercent:e.SCREEN_HEIGHT_PERCENT});return[o,l]}}let n=F(t,{screenHeightPercent:e.SCREEN_HEIGHT_PERCENT});return[ot(t,n.width,n.height),n]}var k=m(p());function G(t){return{x:k.isoParse(t[0]),o:t[1],h:t[2],l:t[3],c:t[4],v:t[5]}}function U(t){return{x:k.isoParse(t.date),o:t.open,h:t.high,l:t.low,c:t.close,v:t.volume}}function P(t,e){var i=!0;return function(){i&&(t.apply(this,arguments),i=!1,setTimeout(()=>{i=!0},e))}}var y=m(p());function A(t,e,i,n=null,s=""){let o=t.append("g").attr("width",e.innerWidth).attr("height",e.innerHeight).attr("class",s).style("visibility","hidden"),h=y.axisLeft(i).tickFormat(n),l=o.call(h).selectAll(".tick text"),c=0,d=0;return l.each(function(){let u=this.getBoundingClientRect();u.width>c&&(c=u.width),u.height>d&&(d=u.height)}),o.remove(),[c,d]}function E(t,e,i,n=0){let s=parseInt(e.innerWidth/(i+1))+1,o=y.max([parseInt(Math.ceil(t.length/s)),1]);return y.filter(t,(h,r)=>r>=n&&r%o===0)}var x=m(p()),Dt=x.utcFormat("%b"),ht=x.utcFormat("%b %-d"),Ht=x.utcFormat("%b %Y"),lt=x.utcFormat("%b %-d, %Y"),Nt=x.utcFormat("%B %-d, %Y");function B(){let t=null;return function(e){let i=e.getUTCFullYear();return t!==i?(t=i,lt(e)):ht(e)}}function ct(t){return 1+Math.sign(t.o-t.c)}var dt=["up","even","down"];function W(t){return dt[ct(t)]}function ut(t,e,i,n){let s=n-i+1,o=1;s<t.length&&(o=t.length/s);let h=e*o,r=i/t.length*h;return[0-r,h-r]}function $(t,e=0,i){return i&&(t=t.slice(e,i+1)),[a.min(a.map(t,s=>s.l)),a.max(a.map(t,s=>s.h))]}function X(t,e){let i=t.domain(),n=t(i[0]),s=t.step(),o=Math.floor((e-n)/s);return Math.max(0,Math.min(o,i.length-1))}var _=class extends T{constructor(i,n=s=>s){super(i,n);H(this,"priceFormat",a.format(",~f"));this.config={VOLUME_RATIO:0,LOG_Y:!1,SCREEN_HEIGHT_PERCENT:.5,BAND_PAD:.1,DURATION_MS:500,PRICE_AXIS_RIGHT:!1,VOLUME_AXIS_RIGHT:!0,HIDE_VOLUME_AXIS:!1,VOLUME_TICK_COUNT:1,RESCALE_Y:!0,MARGIN_RIGHT:10,MARGIN_LEFT:10,MARGIN_LABEL:10,MARGIN_AXES:5,MARGIN_TICK:2},this.data=a.map(i,n),this.X=a.map(this.data,s=>s.x),this.start=0,this.end=this.data.length-1}doNotRescaleY(){return this.config.RESCALE_Y=!1,this}bandPadding(i){return this.config.BAND_PAD=i,this}priceAxisRight(){return this.config.PRICE_AXIS_RIGHT=!0,this}showVolume(i=.1){return this.config.VOLUME_RATIO=i,this}hideVolume(){return this.showVolume(0)}hideVolumeAxis(){return this.config.HIDE_VOLUME_AXIS=!0,this}volumeTickCount(i=1){return this.config.VOLUME_TICK_COUNT=i,this}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}get volumeAxesIsVisible(){return!!this.config.VOLUME_RATIO&&!this.config.HIDE_VOLUME_AXIS}get volumeAxesVisibility(){return this.volumeAxesIsVisible?"visible":"hidden"}get priceTickFormat(){if(this.config.LOG_Y){let i=a.max([this.scaleLinear.ticks().length,2]);return this.scaleLog.tickFormat(i,this.priceFormat)}else return this.priceFormat}get priceAxisIndex(){return this.config.PRICE_AXIS_RIGHT?a.axisRight(this.scaleY).tickFormat(this.priceTickFormat):a.axisLeft(this.scaleY).tickFormat(this.priceTickFormat)}get gridWidth(){return-this.layout.innerWidth-this.config.MARGIN_AXES}get wickThickness(){return a.max([this.scaleX.bandwidth()*.01,1])}makeDateFormatter(){return B()}render(i){if(!this.data.length)return;[this.svg,this.layout]=V(i,this.config);let n=this.layout.innerHeight*this.config.VOLUME_RATIO,s=this.layout.innerHeight-n,o=a.max(a.map(this.data,f=>f.v));if(this.scaleVolume=a.scaleLinear().domain([0,o]).range([n,0]).clamp(!0).nice(),this.volumeAxesIsVisible){let[f,yt]=A(this.svg,this.layout,this.scaleVolume.copy(),b,"v axis");this.layout.pad.right=f+this.config.MARGIN_RIGHT}let h=$(this.data),r=h[0],l=[s,0];this.scaleLinear=a.scaleLinear().domain(h).range(l).clamp(!0),this.scaleLog=a.scaleLog().domain(h).range(l).clamp(!0);let[c,d]=A(this.svg,this.layout,this.scaleLog.copy(),this.priceFormat,"y axis"),[u,ft]=A(this.svg,this.layout,this.scaleLinear.copy(),this.priceFormat,"y axis"),O=a.max([c,u]);this.config.PRICE_AXIS_RIGHT?(this.layout.pad.left=this.config.MARGIN_LEFT,this.layout.pad.right=a.max([this.layout.pad.right,O+this.config.MARGIN_RIGHT])):this.layout.pad.left=a.max([this.layout.pad.left,O+this.config.MARGIN_LEFT]),this.svg.append("defs").append("clipPath").attr("id","inner-clip-path").append("rect").attr("width",this.layout.innerWidth).attr("height",this.layout.innerHeight),this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.pad.left}, ${this.layout.pad.top})`),this.scaleX=a.scaleBand(this.X,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PAD).align(.5);let S=this.makeDateFormatter(),[z,xt]=A(this.svg,this.layout,this.scaleX.copy(),S,"x axis");this.labelWidthX=z+this.config.MARGIN_LABEL;let q=E(this.X,this.layout,this.labelWidthX);S=this.makeDateFormatter(),this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let v=this.priceAxisIndex;this.axisX=a.axisBottom(this.scaleX).tickValues(q).tickFormat(S).tickSize(3);let R="transform(0,0)";this.config.PRICE_AXIS_RIGHT&&(R=`translate(${this.layout.innerWidth+this.config.MARGIN_AXES},0)`),this.gPrice=this.inner.append("g").attr("transform",R).attr("class","y axis").call(v.tickSize(0)),this.grid=this.inner.append("g").attr("transform",R).attr("class","grid").call(v.tickSize(this.gridWidth));let K=this.scaleX.bandwidth()*this.config.BAND_PAD/2;this.gx=this.inner.append("g").attr("class","x axis").attr("transform",`translate(${K+.5},${this.layout.innerHeight+this.config.MARGIN_TICK})`).call(this.axisX),this.price=this.inner.append("g").attr("class","price"),this.candles=this.price.append("g").attr("clip-path","url(#inner-clip-path)").attr("stroke-linecap","butt").attr("stroke","currentColor").selectAll("g").data(this.data).join("g").attr("class",W).attr("transform",f=>`translate(${this.scaleX(f.x)+this.scaleX.step()/2},0)`),this.wicks=this.candles.append("line").attr("stroke-width",this.wickThickness).attr("class","wick").attr("y1",this.scaleY(r)).attr("y2",this.scaleY(r)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class","bar").attr("y1",this.scaleY(r)).attr("y2",this.scaleY(r)),this.axisVolume=a.axisRight(this.scaleVolume).ticks(this.config.VOLUME_TICK_COUNT).tickFormat(b).tickSize(3),this.volume=this.inner.append("g").attr("class","volume").attr("transform",`translate(0,${this.layout.innerHeight-n})`),this.gVolume=this.volume.append("g").attr("class","v axis").attr("transform",`translate(${this.layout.innerWidth+this.config.MARGIN_TICK},0)`).call(this.axisVolume).attr("visibility",this.volumeAxesVisibility),this.volumeSlots=this.volume.append("g").attr("clip-path","url(#inner-clip-path)").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",f=>`translate(${this.scaleX(f.x)+this.scaleX.step()/2},0)`),this.volumeBars=this.volumeSlots.append("line").attr("y1",this.scaleVolume(0)).attr("y2",this.scaleVolume(0)).attr("stroke-width",this.scaleX.bandwidth()).attr("class",W),this.brush=a.brushX().extent([[0,0],[this.layout.innerWidth,this.layout.innerHeight]]).on("end",this.zoom.bind(this)),this.gBrush=this.inner.append("g").attr("class","brush").call(this.brush.bind(this)),this.spotlightBar=this.inner.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none"),this.update()}update(){let i=ut(this.scaleX.domain(),this.layout.innerWidth,this.start,this.end);if(this.scaleX.range(i),this.config.RESCALE_Y){let r=$(this.data,this.start,this.end);this.scaleLinear.domain(r),this.scaleLog.domain(r)}this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let n=this.priceAxisIndex,s=E(this.X.slice(this.start,this.end+1),this.layout,this.labelWidthX),o=this.makeDateFormatter();this.axisX.tickValues(s).tickFormat(o);let h=this.scaleX.bandwidth()*this.config.BAND_PAD/2;this.gx.transition().duration(this.config.DURATION_MS).attr("transform",`translate(${h+.5},${this.layout.innerHeight+this.config.MARGIN_TICK})`).call(this.axisX),this.gPrice.transition().duration(this.config.DURATION_MS).call(n.tickSize(0)),this.grid.transition().duration(this.config.DURATION_MS).call(n.tickFormat("").tickSize(this.gridWidth)),this.candles.transition().duration(this.config.DURATION_MS).attr("transform",r=>`translate(${this.scaleX(r.x)+this.scaleX.step()/2},0)`),this.bars.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()).attr("y1",r=>this.scaleY(r.o)).attr("y2",r=>this.scaleY(r.c)),this.wicks.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.wickThickness).attr("y1",r=>this.scaleY(r.l)).attr("y2",r=>this.scaleY(r.h)),this.noSpotlight(),this.spotlightBar.transition().duration(this.config.DURATION_MS).attr("width",this.scaleX.step()),this.volumeSlots.transition().duration(this.config.DURATION_MS).attr("transform",r=>`translate(${this.scaleX(r.x)+this.scaleX.step()/2},0)`),this.volumeBars.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()).attr("y2",r=>this.scaleVolume(r.v||0))}zoom({selection:i}){if(!i)return;let[n,s]=i;[this.start,this.end]=[X(this.scaleX,n),X(this.scaleX,s)],this.update(),this.gBrush.call(this.brush.move,null)}reset(){this.start=0,this.end=this.data.length-1,this.update()}useLog(){this.config.LOG_Y=!0,this.update()}useLinear(){this.config.LOG_Y=!1,this.update()}spotlight(i){this.spotlightBar.attr("x",this.scaleX(this.data[i].x)).attr("width",this.scaleX.step()).attr("y",0).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}onEvent(i,n){let s=null,o=r=>{let[l]=a.pointer(r),c=X(this.scaleX,l-this.layout.pad.left);if(s&&s==c)return;s=c;let d=structuredClone(this.data[c]);if(d.index=c,c>0){let u=this.data[c-1];u&&u.c&&(d.prev=u.c,d.delta=d.c-u.c,d.percent=d.delta/u.c)}i&&i.call(this,d)},h=r=>{s=null,n&&n.call(this)};this.svg.on("pointermove",P(o,20.83)).on("pointerleave",h)}append(){}};function gt(t,e){return new _(t,e)}function pt(t,e){return new _(t,e).showVolume()}return nt(mt);})();
//# sourceMappingURL=candlestick.min.js.map
