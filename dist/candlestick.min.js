var charts=(()=>{var Q=Object.create;var A=Object.defineProperty;var J=Object.getOwnPropertyDescriptor;var tt=Object.getOwnPropertyNames;var it=Object.getPrototypeOf,et=Object.prototype.hasOwnProperty;var st=(t,i,e)=>i in t?A(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var nt=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),rt=(t,i)=>{for(var e in i)A(t,e,{get:i[e],enumerable:!0})},E=(t,i,e,n)=>{if(i&&typeof i=="object"||typeof i=="function")for(let s of tt(i))!et.call(t,s)&&s!==e&&A(t,s,{get:()=>i[s],enumerable:!(n=J(i,s))||n.enumerable});return t};var p=(t,i,e)=>(e=t!=null?Q(it(t)):{},E(i||!t||!t.__esModule?A(e,"default",{value:t,enumerable:!0}):e,t)),at=t=>E(A({},"__esModule",{value:!0}),t);var H=(t,i,e)=>st(t,typeof i!="symbol"?i+"":i,e);var f=nt((St,v)=>{v.exports=d3});var xt={};rt(xt,{CandlestickChart:()=>w,OHLC:()=>pt,OHLCV:()=>mt,parseArrayOHLCV:()=>N,parseVerboseOHLCV:()=>G,placeTooltip:()=>$,placeTooltipTop:()=>z});var a=p(f());var F=p(f());var ot=p(f());var S=class{constructor(i,e=n=>n){}screenHeightPercent(i){return this.config.LAYOUT.screenHeightPercent=i,this}minHeight(i){return this.config.LAYOUT.minHeight=i,this}maxHeight(i){return this.config.LAYOUT.maxHeight=i,this}height(i){return this.minHeight(i).maxHeight(i)}minWidth(i){return this.config.LAYOUT.minWidth=i,this}maxWidth(i){return this.config.LAYOUT.maxWidth=i,this}width(i){return this.minWidth(i).maxWidth(i)}animationDuration(i){return this.config.DURATION_MS=i,this}noAnimation(){return this.animationDuration(0)}node(){return this.svg?this.svg.node():null}};var O=p(f()),Ot=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,Rt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,Yt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,ht=O.format(",.0f"),Dt=O.format(",.2f"),R=function(t){if(t)return t>=1e9?`${t/1e9}B`:t>=1e6?`${t/1e6}M`:ht(t)};var u=p(f()),Y=class{constructor(i,e,n,s){this.top=i,this.right=e,this.bottom=n,this.left=s}};function U(){return new Y(15,15,25,25)}var _=class{constructor(i,e,n){this.width=i,this.height=e,this.pad=n||U()}get rangeX(){return[this.pad.left,this.width-this.pad.right]}get rangeY(){return[this.height-this.pad.bottom,this.pad.top]}get innerWidth(){return this.width-this.pad.left-this.pad.right}get innerHeight(){return this.height-this.pad.top-this.pad.bottom}get innerMinimum(){return u.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function V(t,{minWidth:i=400,maxWidth:e=void 0,minHeight:n=300,maxHeight:s=void 0,screenHeightPercent:r=.5}={}){let l=document.querySelector(t),o=u.max([l.offsetWidth,i]);e&&(o=u.min([o,e]));let h=window.innerHeight*r;return h=u.max([h,n]),s&&(h=u.min([h,s])),new _(o,h,U())}function lt(t,i,e){return u.select(t).append("svg").attr("viewBox",`0 0 ${i} ${e}`).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("overflow","visible")}function C(t,i){let e=u.select(t);if(!e.node())throw new Error(`Unable to find a DOM element for selector '${t}'`);if(e.node().tagName==="svg"){let r=e,l=+r.attr("width"),o=+r.attr("height");if(l&&o)return[r,new _(l,o)];{let h=V(t,i);return[r,h]}}let n=V(t,i);return[lt(t,n.width,n.height),n]}var D=p(f());function N(t){return{x:D.isoParse(t[0]),o:t[1],h:t[2],l:t[3],c:t[4],v:t[5]}}function G(t){return{x:D.isoParse(t.date),o:t.open,h:t.high,l:t.low,c:t.close,v:t.volume}}function k(t,i){var e=!0;return function(){e&&(t.apply(this,arguments),e=!1,setTimeout(()=>{e=!0},i))}}var y=p(f());function I(t,i,e,n=null,s=""){let r=t.append("g").attr("width",i.innerWidth).attr("height",i.innerHeight).attr("class",s).style("visibility","hidden"),l=y.axisLeft(e).tickFormat(n),h=r.call(l).selectAll(".tick text"),c=0,d=0;return h.each(function(){let g=this.getBoundingClientRect();g.width>c&&(c=g.width),g.height>d&&(d=g.height)}),r.remove(),[c,d]}function B(t,i,e){let n=parseInt(i.innerWidth/(e+1))+1,s=y.max([parseInt(Math.ceil(t.length/n)),1]),r=s>1?Math.floor(s/2):0;return y.filter(t,(l,o)=>o-r>=0&&(o-r)%s===0)}function T(t,i){let e=t.domain(),n=Math.floor((i-t(e[0]))/t.step());return Math.max(0,Math.min(n,e.length-1))}function W(t,i,e,n){let s=n-e+1,r=1;s<t.length&&(r=t.length/s);let l=i*r,o=e/t.length*l;return[0-o,l-o]}var m=p(f()),vt=m.utcFormat("%b"),ct=m.utcFormat("%b %-d"),Ft=m.utcFormat("%b %Y"),dt=m.utcFormat("%b %-d, %Y"),Vt=m.utcFormat("%B %-d, %Y");function P(){let t=null;return function(i){let e=i.getUTCFullYear();return t!==e?(t=e,dt(i)):ct(i)}}function $(t,i,e,n,s=5){let r=t.getBoundingClientRect(),l=e-r.left-window.scrollX,o=n-r.top-window.scrollY,h=s,c=-i.offsetHeight-s,d="left";return l>r.width-i.offsetWidth-s&&(h=-i.offsetWidth-s,d="right"),o<i.offsetHeight+s&&(c=s),[e+h,n+c,d]}function z(t,i,e,n,s=5){let r=t.getBoundingClientRect(),l=e-r.left-window.scrollX,o=s,h=-i.offsetHeight-s,c="left";return l>r.width-i.offsetWidth-s&&(o=-i.offsetWidth-s,c="right"),[e+o,n+h,c]}var ut=0;function gt(t){return 1+Math.sign(t.o-t.c)}var ft=["up","even","down"];function q(t){return ft[gt(t)]}function Z(t,i=0,e){return e&&(t=t.slice(i,e+1)),[a.min(a.map(t,s=>s.l)),a.max(a.map(t,s=>s.h))]}var w=class extends S{constructor(e,n=s=>s){super(e,n);H(this,"priceFormat",a.format(",~f"));this.config={VOLUME_RATIO:0,LOG_Y:!1,BAND_PAD:.1,FPS:48,DURATION_MS:500,DELAY_MS:0,DELAY_ONCE:!1,DISABLE_BRUSH:!1,PRICE_AXIS_RIGHT:!1,VOLUME_AXIS_RIGHT:!0,HIDE_VOLUME_AXIS:!1,VOLUME_TICK_COUNT:1,RESCALE_Y:!0,LAYOUT:{},MARGIN_RIGHT:10,MARGIN_LEFT:10,MARGIN_LABEL:10,MARGIN_AXES:5,MARGIN_TICK:2},this.opened=!1,this.data=a.map(e,n),this.X=a.map(this.data,s=>s.x),this.start=0,this.end=this.data.length-1}doNotRescaleY(){return this.config.RESCALE_Y=!1,this}bandPadding(e){return this.config.BAND_PAD=e,this}priceAxisRight(){return this.config.PRICE_AXIS_RIGHT=!0,this}showVolume(e=.1){return this.config.VOLUME_RATIO=e,this}hideVolume(){return this.showVolume(0)}hideVolumeAxis(){return this.config.HIDE_VOLUME_AXIS=!0,this}volumeTickCount(e=1){return this.config.VOLUME_TICK_COUNT=e,this}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}disableZoom(){return this.config.DISABLE_BRUSH=!0,this}staggerOpening(e=0){return this.config.DELAY_ONCE=!0,this.staggerAnimation(e)}staggerAnimation(e=0){return e||(e=this.config.DURATION_MS/(this.X.length+1)),this.config.DELAY_MS=e,this}noStaggerAnimation(){return this.config.DELAY_MS=0,this}delay(e,n){return this.config.DELAY_ONCE&&this.opened?0:n*this.config.DELAY_MS}get volumeAxesIsVisible(){return!!this.config.VOLUME_RATIO&&!this.config.HIDE_VOLUME_AXIS}get volumeAxesVisibility(){return this.volumeAxesIsVisible?"visible":"hidden"}get priceTickFormat(){if(this.config.LOG_Y){let e=a.max([this.scaleLinear.ticks().length,2]);return this.scaleLog.tickFormat(e,this.priceFormat)}else return this.priceFormat}get priceAxisIndex(){return this.config.PRICE_AXIS_RIGHT?a.axisRight(this.scaleY).tickFormat(this.priceTickFormat):a.axisLeft(this.scaleY).tickFormat(this.priceTickFormat)}get gridWidth(){return-this.layout.innerWidth-this.config.MARGIN_AXES}get wickThickness(){return a.max([this.scaleX.bandwidth()*.01,1])}makeDateFormatter(){return P()}get xValues(){return B(this.X.slice(this.start,this.end+1),this.layout,this.labelWidthX)}updateLayout(){}render(e){if(!this.data.length)return;let n=`candlestick-clip-path-${ut++}`;[this.svg,this.layout]=C(e,this.config.LAYOUT);let s=this.layout.innerHeight*this.config.VOLUME_RATIO,r=this.layout.innerHeight-s,l=a.max(a.map(this.data,x=>x.v));if(this.scaleVolume=a.scaleLinear().domain([0,l]).range([s,0]).clamp(!0).nice(),this.volumeAxesIsVisible){let[x,It]=I(this.svg,this.layout,this.scaleVolume.copy(),R,"v axis");this.layout.pad.right=x+this.config.MARGIN_RIGHT}let o=Z(this.data),h=o[0],c=[r,0];this.scaleLinear=a.scaleLinear().domain(o).range(c).clamp(!0),this.scaleLog=a.scaleLog().domain(o).range(c).clamp(!0);let[d,g]=I(this.svg,this.layout,this.scaleLog.copy(),this.priceFormat,"y axis"),[K,yt]=I(this.svg,this.layout,this.scaleLinear.copy(),this.priceFormat,"y axis"),X=a.max([d,K]);this.config.PRICE_AXIS_RIGHT?(this.layout.pad.left=this.config.MARGIN_LEFT,this.layout.pad.right=a.max([this.layout.pad.right,X+this.config.MARGIN_RIGHT])):this.layout.pad.left=a.max([this.layout.pad.left,X+this.config.MARGIN_LEFT]),this.svg.append("defs").append("clipPath").attr("id",n).append("rect").attr("width",this.layout.innerWidth).attr("height",this.layout.innerHeight),this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.pad.left}, ${this.layout.pad.top})`),this.scaleX=a.scaleBand(this.X,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PAD).paddingOuter(this.config.BAND_PAD/2);let L=this.makeDateFormatter(),[j,At]=I(this.svg,this.layout,this.scaleX.copy(),L,"x axis");this.labelWidthX=j+this.config.MARGIN_LABEL;let b="transform(0,0)";this.config.PRICE_AXIS_RIGHT&&(b=`translate(${this.layout.innerWidth+this.config.MARGIN_AXES},0)`),L=this.makeDateFormatter(),this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let M=this.priceAxisIndex;this.grid=this.inner.append("g").attr("transform",b).attr("class","grid").call(M.tickSize(this.gridWidth)),this.axisX=a.axisBottom(this.scaleX).tickValues(this.xValues).tickFormat(L).tickSize(4),this.gPrice=this.inner.append("g").attr("transform",b).attr("class","y axis").call(M.tickSize(0)),this.axisVolume=a.axisRight(this.scaleVolume).ticks(this.config.VOLUME_TICK_COUNT).tickFormat(R).tickSize(3),this.volume=this.inner.append("g").attr("class","volume").attr("transform",`translate(0,${this.layout.innerHeight-s})`),this.gVolume=this.volume.append("g").attr("class","v axis").attr("transform",`translate(${this.layout.innerWidth+this.config.MARGIN_TICK},0)`).call(this.axisVolume).attr("visibility",this.volumeAxesVisibility),this.volumeSlots=this.volume.append("g").attr("clip-path",`url(#${n})`).attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",x=>`translate(${this.scaleX(x.x)+this.scaleX.bandwidth()/2},0)`),this.volumeBars=this.volumeSlots.append("line").attr("y1",this.scaleVolume(0)).attr("y2",this.scaleVolume(0)).attr("stroke-width",this.scaleX.bandwidth()).attr("class",q),this.price=this.inner.append("g").attr("class","price"),this.candles=this.price.append("g").attr("clip-path",`url(#${n})`).attr("stroke-linecap","butt").attr("stroke","currentColor").selectAll("g").data(this.data).join("g").attr("class",q).attr("transform",x=>`translate(${this.scaleX(x.x)+this.scaleX.bandwidth()/2},0)`),this.wicks=this.candles.append("line").attr("stroke-width",this.wickThickness).attr("class","wick").attr("y1",this.scaleY(h)).attr("y2",this.scaleY(h)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class","bar").attr("y1",this.scaleY(h)).attr("y2",this.scaleY(h)),this.gx=this.inner.append("g").attr("class","x axis").attr("transform",`translate(0,${this.layout.innerHeight})`).call(this.axisX),this.brush=a.brushX().extent([[0,0],[this.layout.innerWidth,this.layout.innerHeight]]),this.gBrush=this.inner.append("g").attr("class","brush"),this.config.DISABLE_BRUSH||(this.brush.on("end",this.zoom.bind(this)),this.gBrush.call(this.brush.bind(this))),this.spotlightBar=this.inner.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none"),this.update()}update(){let e=W(this.scaleX.domain(),this.layout.innerWidth,this.start,this.end);if(this.scaleX.range(e),this.config.RESCALE_Y){let r=Z(this.data,this.start,this.end);this.scaleLinear.domain(r),this.scaleLog.domain(r)}this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let n=this.priceAxisIndex,s=this.makeDateFormatter();this.axisX.tickValues(this.xValues).tickFormat(s),this.gx.transition().duration(this.config.DURATION_MS).attr("transform",`translate(0,${this.layout.innerHeight})`).call(this.axisX),this.gPrice.transition().duration(this.config.DURATION_MS).call(n.tickSize(0)),this.grid.transition().duration(this.config.DURATION_MS).call(n.tickFormat("").tickSize(this.gridWidth)),this.candles.transition().duration(this.config.DURATION_MS).attr("transform",r=>`translate(${this.scaleX(r.x)+this.scaleX.bandwidth()/2},0)`),this.bars.transition().delay(this.delay.bind(this)).duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()).attr("y1",r=>this.scaleY(r.o)).attr("y2",r=>this.scaleY(r.c)),this.wicks.transition().delay(this.delay.bind(this)).duration(this.config.DURATION_MS).attr("stroke-width",this.wickThickness).attr("y1",r=>this.scaleY(r.l)).attr("y2",r=>this.scaleY(r.h)),this.noSpotlight(),this.spotlightBar.transition().duration(this.config.DURATION_MS).attr("width",this.scaleX.step()),this.volumeSlots.transition().duration(this.config.DURATION_MS).attr("transform",r=>`translate(${this.scaleX(r.x)+this.scaleX.bandwidth()/2},0)`),this.volumeBars.transition().delay(this.delay.bind(this)).duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()).attr("y2",r=>this.scaleVolume(r.v||0)),this.opened=!0}zoom({selection:e}){if(!e)return;let[n,s]=e;[this.start,this.end]=[T(this.scaleX,n),T(this.scaleX,s)],this.update(),this.gBrush.call(this.brush.move,null)}reset(){this.start=0,this.end=this.data.length-1,this.update()}useLog(){this.config.LOG_Y=!0,this.update()}useLinear(){this.config.LOG_Y=!1,this.update()}spotlight(e){let n=this.scaleX.step()*this.scaleX.paddingOuter();this.spotlightBar.attr("x",this.scaleX(this.data[e].x)-n).attr("width",this.scaleX.step()).attr("y",0).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}onEvent(e,n){let s=null,r=o=>{o.touches&&(o.preventDefault(),o=o.touches[0]);let[h]=a.pointer(o),c=T(this.scaleX,h-this.layout.pad.left);s=c;let d=structuredClone(this.data[c]);if(d.index=c,[d.px,d.py]=a.pointer(o,null),c>0){let g=this.data[c-1];g&&g.c&&(d.prev=g.c,d.delta=d.c-g.c,d.percent=d.delta/g.c)}e&&e.call(this,d)},l=o=>{s=null,n&&n.call(this)};this.svg.on("mousemove",k(r,1e3/this.config.FPS)).on("mouseleave",l).on("touchstart",r,{passive:!1}).on("touchmove",k(r,1e3/this.config.FPS),{passive:!1}).on("touchend",l,{passive:!1})}append(){}};function pt(t,i){return new w(t,i)}function mt(t,i){return new w(t,i).showVolume()}return at(xt);})();
//# sourceMappingURL=candlestick.min.js.map
