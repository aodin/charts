var charts=(()=>{var B=Object.create;var m=Object.defineProperty;var E=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var G=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty;var P=(i,t,e)=>t in i?m(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var $=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),z=(i,t)=>{for(var e in t)m(i,e,{get:t[e],enumerable:!0})},X=(i,t,e,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of W(t))!V.call(i,a)&&a!==e&&m(i,a,{get:()=>t[a],enumerable:!(s=E(t,a))||s.enumerable});return i};var L=(i,t,e)=>(e=i!=null?B(G(i)):{},X(t||!i||!i.__esModule?m(e,"default",{value:i,enumerable:!0}):e,i)),q=i=>X(m({},"__esModule",{value:!0}),i);var _=(i,t,e)=>P(i,typeof t!="symbol"?t+"":t,e);var x=$((ot,O)=>{O.exports=d3});var it={};z(it,{Candlestick:()=>y,OHLC:()=>J,OHLCV:()=>tt});var n=L(x());var c=L(x()),Y=class{constructor(t,e,s,a){this.top=t,this.right=e,this.bottom=s,this.left=a}};function S(){return new Y(15,15,25,25)}var f=class{constructor(t,e,s){this.width=t,this.height=e,this.padding=s||S()}get rangeX(){return[this.padding.left,this.width-this.padding.right]}get rangeY(){return[this.height-this.padding.bottom,this.padding.top]}get innerWidth(){return this.width-this.padding.left-this.padding.right}get innerHeight(){return this.height-this.padding.top-this.padding.bottom}get innerMinimum(){return c.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function F(i,{minWidth:t=400,maxWidth:e=void 0,minHeight:s=300,maxHeight:a=void 0,screenHeightFraction:p=.5}={}){let l=document.querySelector(i);console.log(l.getBoundingClientRect());let r=c.max([l.offsetWidth,t]);e&&(r=c.min([r,e]));let o=window.innerHeight*p;return o=c.max([o,s]),a&&(o=c.min([o,a])),new f(r,o,S())}function w(i,t,e=null){let s=d3.select("body").append("svg").attr("width",i.innerWidth).attr("height",i.innerHeight).style("visibility","hidden"),a=d3.axisLeft(t).tickFormat(e),l=s.append("g").call(a).selectAll(".tick text"),r=0,o=0;return l.each(function(){let d=this.getBoundingClientRect();d.width>r&&(r=d.width),d.height>o&&(o=d.height)}),s.remove(),[r,o]}function H(i,t,e){let s=parseInt(t.innerWidth/(e+1))+1,a=d3.max([parseInt(Math.ceil(i.length/s)),1]);return d3.filter(i,(p,l)=>l%a===0)}var u=L(x()),ct=u.utcFormat("%b"),j=u.utcFormat("%b %-d"),dt=u.utcFormat("%b %Y"),K=u.utcFormat("%b %-d, %Y"),gt=u.utcFormat("%B %-d, %Y");function k(){let i=null;return function(t){let e=t.getUTCFullYear();return i!==e?(i=e,K(t)):j(t)}}function Q(i){return 1+Math.sign(i.o-i.c)}function Z(i){return["bar",["up","even","down"][Q(i)]].join(" ")}var y=class{constructor(t){_(this,"formatX","%m %d, %Y");this.config={VOLUME_RATIO:0,LOG_Y:!1,SCREEN_HEIGHT_FRACTION:.5,BAND_PADDING:.2,DURATION_MS:500},this.data=n.map(t,e=>({d:n.isoParse(e[0]),o:e[1],h:e[2],l:e[3],c:e[4],v:e[5]}))}append(){}animationDuration(t){return this.config.DURATION_MS=t,this}noAnimation(){return this.animationDuration(0)}showVolume(t=.1){return this.config.VOLUME_RATIO=t,this}hideVolume(){return this.showVolume(0)}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}render(t){this.svg=n.select(t);let e=+this.svg.attr("width"),s=+this.svg.attr("height");e&&s?this.layout=new f(e,s):(this.layout=F(t,{screenHeightFraction:this.config.SCREEN_HEIGHT_FRACTION}),console.log(this.layout.width,this.layout.height));let a=this.layout.innerHeight*this.config.VOLUME_RATIO,p=this.layout.innerHeight-a,l=n.min(n.map(this.data,h=>h.l)),r=[l,n.max(n.map(this.data,h=>h.h))],o=(r[1]-r[0])*.1;console.log("domainPaddingY",o),r=[r[0]-o,r[1]+o];let d=[p,0];this.scaleLog=n.scaleLog().domain(r).range(d).clamp(!0),this.scaleLinear=n.scaleLinear().domain(r).range(d).clamp(!0);let T=n.map(this.data,h=>h.d);console.log("rangeX",T);let[C,et]=w(this.layout,this.scaleLog),[N,nt]=w(this.layout,this.scaleLinear),A=n.max([C,N]);console.log("Y size:",A),this.layout.padding.left=A+10,this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.padding.left}, ${this.layout.padding.top})`),this.price=this.inner.append("g").attr("transform","translate(0,0)"),this.volume=this.inner.append("g").attr("transform",`translate(0,${a})`),this.scaleX=n.scaleBand(T,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PADDING).align(.5).round(!0);let b=k(),[D,at]=w(this.layout,this.scaleX,b);console.log("labelWidth",D);let R=n.map(this.data,h=>h.d),I=H(R,this.layout,D);console.log("TICKS",I),b=k();let g=this.config.LOG_Y?this.scaleLog:this.scaleLinear,v=n.axisLeft(g).tickSize(0),M=n.axisBottom(this.scaleX).tickValues(I).tickFormat(b);this.elemAxisY=this.inner.append("g").attr("class","y axis").attr("transform","translate(0,0)").call(v).call(h=>h.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",0).attr("x2",this.layout.innerWidth));let U=this.scaleX.bandwidth()*this.config.BAND_PADDING/2,st=this.inner.append("g").attr("class","x axis").attr("transform",`translate(${U+.5},${this.layout.innerHeight})`).call(M);console.log("this.scaleX.step()",this.scaleX.step()),console.log("this.scaleX.bandwidth()",this.scaleX.bandwidth()),this.candles=this.inner.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",h=>`translate(${this.scaleX(h.d)+this.scaleX.step()/2},0)`),this.wicks=this.candles.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("class","wick").attr("opacity",.8).attr("y1",g(l)).attr("y2",g(l)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class",h=>Z(h)).attr("y1",g(l)).attr("y2",g(l)),this.updateScale(g),this.spotlightBar=this.svg.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none")}updateScale(t){this.elemAxisY.transition().duration(this.config.DURATION_MS).call(n.axisLeft(t).tickSize(0)),this.bars.transition().duration(this.config.DURATION_MS).attr("y1",e=>t(e.o)).attr("y2",e=>t(e.c)),this.wicks.transition().duration(this.config.DURATION_MS).attr("y1",e=>t(e.l)).attr("y2",e=>t(e.h))}useLog(){this.updateScale(this.scaleLog)}useLinear(){this.updateScale(this.scaleLinear)}spotlight(t){this.spotlightBar.attr("x",this.scaleX(this.data[t].d)).attr("width",this.scaleX.bandwidth()).attr("y",this.layout.padding.top).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}};function J(i,t){return new y(i,t)}function tt(i,t){return new y(i,t).showVolume()}return q(it);})();
//# sourceMappingURL=candlestick.min.js.map
