var charts=(()=>{var G=Object.create;var x=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var V=Object.getOwnPropertyNames;var z=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var q=(e,t,i)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var j=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),K=(e,t)=>{for(var i in t)x(e,i,{get:t[i],enumerable:!0})},X=(e,t,i,s)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of V(t))!P.call(e,a)&&a!==i&&x(e,a,{get:()=>t[a],enumerable:!(s=$(t,a))||s.enumerable});return e};var L=(e,t,i)=>(i=e!=null?G(z(e)):{},X(t||!e||!e.__esModule?x(i,"default",{value:e,enumerable:!0}):i,e)),Z=e=>X(x({},"__esModule",{value:!0}),e);var _=(e,t,i)=>q(e,typeof t!="symbol"?t+"":t,i);var y=j((ht,O)=>{O.exports=d3});var at={};K(at,{Candlestick:()=>w,OHLC:()=>et,OHLCV:()=>nt});var n=L(y());var d=L(y()),k=class{constructor(t,i,s,a){this.top=t,this.right=i,this.bottom=s,this.left=a}};function C(){return new k(15,15,25,25)}var b=class{constructor(t,i,s){this.width=t,this.height=i,this.padding=s||C()}get rangeX(){return[this.padding.left,this.width-this.padding.right]}get rangeY(){return[this.height-this.padding.bottom,this.padding.top]}get innerWidth(){return this.width-this.padding.left-this.padding.right}get innerHeight(){return this.height-this.padding.top-this.padding.bottom}get innerMinimum(){return d.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function H(e,{minWidth:t=400,maxWidth:i=void 0,minHeight:s=300,maxHeight:a=void 0,screenHeightFraction:c=.5}={}){let l=document.querySelector(e);console.log(l.getBoundingClientRect());let o=d.max([l.offsetWidth,t]);i&&(o=d.min([o,i]));let r=window.innerHeight*c;return r=d.max([r,s]),a&&(r=d.min([r,a])),new b(o,r,C())}function Y(e,t,i=null){let s=d3.select("body").append("svg").attr("width",e.innerWidth).attr("height",e.innerHeight).style("visibility","hidden"),a=d3.axisLeft(t).tickFormat(i),l=s.append("g").call(a).selectAll(".tick text"),o=0,r=0;return l.each(function(){let g=this.getBoundingClientRect();g.width>o&&(o=g.width),g.height>r&&(r=g.height)}),s.remove(),[o,r]}function N(e,t,i){let s=parseInt(t.innerWidth/(i+1))+1,a=d3.max([parseInt(Math.ceil(e.length/s)),1]);return d3.filter(e,(c,l)=>l%a===0)}var f=L(y()),gt=f.utcFormat("%b"),Q=f.utcFormat("%b %-d"),ut=f.utcFormat("%b %Y"),J=f.utcFormat("%b %-d, %Y"),pt=f.utcFormat("%B %-d, %Y");function I(){let e=null;return function(t){let i=t.getUTCFullYear();return e!==i?(e=i,J(t)):Q(t)}}function v(e,t){var i=!0;return function(){i&&(e.apply(this,arguments),i=!1,setTimeout(()=>{i=!0},t))}}var U=L(y()),xt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,yt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,bt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,wt=U.format(",.0f");function tt(e){return 1+Math.sign(e.o-e.c)}function it(e){return["bar",["up","even","down"][tt(e)]].join(" ")}var w=class{constructor(t){_(this,"formatX","%m %d, %Y");this.config={VOLUME_RATIO:0,LOG_Y:!1,SCREEN_HEIGHT_FRACTION:.5,BAND_PADDING:.2,DURATION_MS:500},this.data=n.map(t,i=>({x:n.isoParse(i[0]),o:i[1],h:i[2],l:i[3],c:i[4],v:i[5]}))}append(){}animationDuration(t){return this.config.DURATION_MS=t,this}noAnimation(){return this.animationDuration(0)}showVolume(t=.1){return this.config.VOLUME_RATIO=t,this}hideVolume(){return this.showVolume(0)}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}render(t){this.svg=n.select(t);let i=+this.svg.attr("width"),s=+this.svg.attr("height");i&&s?this.layout=new b(i,s):this.layout=H(t,{screenHeightFraction:this.config.SCREEN_HEIGHT_FRACTION});let a=this.layout.innerHeight*this.config.VOLUME_RATIO,c=this.layout.innerHeight-a,l=n.min(n.map(this.data,h=>h.l)),o=[l,n.max(n.map(this.data,h=>h.h))],r=(o[1]-o[0])*.1;console.log("domainPaddingY",r),o=[o[0]-r,o[1]+r];let g=[c,0];this.scaleLog=n.scaleLog().domain(o).range(g).clamp(!0),this.scaleLinear=n.scaleLinear().domain(o).range(g).clamp(!0);let u=n.map(this.data,h=>h.x);console.log("rangeX",u);let[p,D]=Y(this.layout,this.scaleLog),[R,st]=Y(this.layout,this.scaleLinear),T=n.max([p,R]);console.log("Y size:",T),this.layout.padding.left=T+10,this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.padding.left}, ${this.layout.padding.top})`),this.price=this.inner.append("g").attr("transform","translate(0,0)"),this.volume=this.inner.append("g").attr("transform",`translate(0,${a})`),this.scaleX=n.scaleBand(u,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PADDING).align(.5).round(!0);let F=I(),[A,rt]=Y(this.layout,this.scaleX,F);console.log("labelWidth",A);let M=n.map(this.data,h=>h.x),S=N(M,this.layout,A);console.log("TICKS",S),F=I();let m=this.config.LOG_Y?this.scaleLog:this.scaleLinear,B=n.axisLeft(m).tickSize(0),E=n.axisBottom(this.scaleX).tickValues(S).tickFormat(F).tickSize(3);this.elemAxisY=this.inner.append("g").attr("class","y axis").attr("transform","translate(0,0)").call(B).call(h=>h.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",0).attr("x2",this.layout.innerWidth));let W=this.scaleX.bandwidth()*this.config.BAND_PADDING/2,ot=this.inner.append("g").attr("class","x axis").attr("transform",`translate(${W+.5},${this.layout.innerHeight})`).call(E);console.log("this.scaleX.step()",this.scaleX.step()),console.log("this.scaleX.bandwidth()",this.scaleX.bandwidth()),this.candles=this.inner.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",h=>`translate(${this.scaleX(h.x)+this.scaleX.step()/2},0)`),this.wicks=this.candles.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("class","wick").attr("opacity",.8).attr("y1",m(l)).attr("y2",m(l)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class",h=>it(h)).attr("y1",m(l)).attr("y2",m(l)),this.updateScale(m),this.spotlightBar=this.inner.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none")}updateScale(t){this.elemAxisY.transition().duration(this.config.DURATION_MS).call(n.axisLeft(t).tickSize(0)),this.bars.transition().duration(this.config.DURATION_MS).attr("y1",i=>t(i.o)).attr("y2",i=>t(i.c)),this.wicks.transition().duration(this.config.DURATION_MS).attr("y1",i=>t(i.l)).attr("y2",i=>t(i.h))}useLog(){this.updateScale(this.scaleLog)}useLinear(){this.updateScale(this.scaleLinear)}spotlight(t){this.spotlightBar.attr("x",this.scaleX(this.data[t].x)+5).attr("width",this.scaleX.bandwidth()).attr("y",0).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}onEvent(t,i){let s=n.map(this.data,r=>[this.scaleX(r.x)+this.scaleX.step()/2+this.layout.padding.left,1]),a=n.Delaunay.from(s),c=null,l=r=>{let[g]=n.pointer(r),u=a.find(g,1);if(c&&c==u)return;c=u;let p=structuredClone(this.data[u]);if(p.index=u,u>0){let D=this.data[u-1];D&&(p.delta=p.c-D.c,p.percent=p.delta/D.c)}t&&t.call(this,p)},o=r=>{c=null,i&&i.call(this)};this.svg.on("pointermove",v(l,20.83)).on("pointerleave",o)}};function et(e,t){return new w(e,t)}function nt(e,t){return new w(e,t).showVolume()}return Z(at);})();
//# sourceMappingURL=candlestick.min.js.map
