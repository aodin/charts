var charts=(()=>{var W=Object.create;var y=Object.defineProperty;var $=Object.getOwnPropertyDescriptor;var z=Object.getOwnPropertyNames;var K=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var j=(t,i,e)=>i in t?y(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var Z=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),Q=(t,i)=>{for(var e in i)y(t,e,{get:i[e],enumerable:!0})},M=(t,i,e,n)=>{if(i&&typeof i=="object"||typeof i=="function")for(let a of z(i))!q.call(t,a)&&a!==e&&y(t,a,{get:()=>i[a],enumerable:!(n=$(i,a))||n.enumerable});return t};var I=(t,i,e)=>(e=t!=null?W(K(t)):{},M(i||!t||!t.__esModule?y(e,"default",{value:t,enumerable:!0}):e,t)),J=t=>M(y({},"__esModule",{value:!0}),t);var N=(t,i,e)=>j(t,typeof i!="symbol"?i+"":i,e);var m=Z((mt,Y)=>{Y.exports=d3});var dt={};Q(dt,{Candlestick:()=>A,OHLC:()=>lt,OHLCV:()=>ct,parseArray:()=>nt,parseVerboseObject:()=>rt});var s=I(m());var d=I(m()),E=class{constructor(i,e,n,a){this.top=i,this.right=e,this.bottom=n,this.left=a}};function D(){return new E(15,15,25,25)}var T=class{constructor(i,e,n){this.width=i,this.height=e,this.pad=n||D()}get rangeX(){return[this.pad.left,this.width-this.pad.right]}get rangeY(){return[this.height-this.pad.bottom,this.pad.top]}get innerWidth(){return this.width-this.pad.left-this.pad.right}get innerHeight(){return this.height-this.pad.top-this.pad.bottom}get innerMinimum(){return d.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function O(t,{minWidth:i=400,maxWidth:e=void 0,minHeight:n=300,maxHeight:a=void 0,screenHeightPercent:o=.5}={}){let r=document.querySelector(t),l=d.max([r.offsetWidth,i]);e&&(l=d.min([l,e]));let h=window.innerHeight*o;return h=d.max([h,n]),a&&(h=d.min([h,a])),new T(l,h,D())}function tt(t,i,e){return d.select(t).append("svg").attr("viewBox",[0,0,i,e]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("overflow","visible")}function F(t,i){let e=d.select(t);if(!e.node())throw new Error(`Unable to find a DOM element for selector '${t}'`);if(e.node().tagName==="svg"){let o=e,r=+o.attr("width"),l=+o.attr("height");if(r&&l)return[o,new T(r,l)];{let h=O(t,{screenHeightPercent:i.SCREEN_HEIGHT_PERCENT});return[o,h]}}let n=O(t,{screenHeightPercent:i.SCREEN_HEIGHT_PERCENT});return[tt(t,n.width,n.height),n]}var f=I(m());function _(t,i,e,n=null,a=""){let o=t.append("g").attr("width",i.innerWidth).attr("height",i.innerHeight).attr("class",a).style("visibility","hidden"),r=f.axisLeft(e).tickFormat(n),h=o.call(r).selectAll(".tick text"),c=0,u=0;return h.each(function(){let x=this.getBoundingClientRect();x.width>c&&(c=x.width),x.height>u&&(u=x.height)}),o.remove(),[c,u]}function L(t,i,e){let n=parseInt(i.innerWidth/(e+1))+1,a=f.max([parseInt(Math.ceil(t.length/n)),1]);return f.filter(t,(o,r)=>r%a===0)}var p=I(m()),yt=p.utcFormat("%b"),it=p.utcFormat("%b %-d"),It=p.utcFormat("%b %Y"),et=p.utcFormat("%b %-d, %Y"),_t=p.utcFormat("%B %-d, %Y");function b(){let t=null;return function(i){let e=i.getUTCFullYear();return t!==e?(t=e,et(i)):it(i)}}function H(t,i){var e=!0;return function(){e&&(t.apply(this,arguments),e=!1,setTimeout(()=>{e=!0},i))}}var C=I(m()),bt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,Rt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,wt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,st=C.format(",.0f"),X=function(t){if(t)return t>=1e9?`${t/1e9}B`:t>=1e6?`${t/1e6}M`:st(t)};function nt(t){return{x:s.isoParse(t[0]),o:t[1],h:t[2],l:t[3],c:t[4],v:t[5]}}function rt(t){return{x:s.isoParse(t.date),o:t.open,h:t.high,l:t.low,c:t.close,v:t.volume}}function at(t){return 1+Math.sign(t.o-t.c)}var ot=["up","even","down"];function G(t){return ot[at(t)]}function ht(t,i,e,n){let a=n-e+1,o=1;a<t.length&&(o=t.length/a);let r=i*o,l=e/t.length*r;return[0-l,r-l]}function V(t,i=0,e){return e&&(t=t.slice(i,e+1)),[s.min(s.map(t,a=>a.l)),s.max(s.map(t,a=>a.h))]}function S(t,i){let e=t.domain(),n=t(e[0]),a=t.step(),o=Math.floor((i-n)/a);return Math.max(0,Math.min(o,e.length-1))}var A=class{constructor(i,e=n=>n){N(this,"priceFormat",s.format(",~f"));this.config={VOLUME_RATIO:0,LOG_Y:!1,SCREEN_HEIGHT_PERCENT:.5,BAND_PAD:.1,DURATION_MS:500,PRICE_AXIS_RIGHT:!1,VOLUME_AXIS_RIGHT:!0,HIDE_VOLUME_AXIS:!1,VOLUME_TICK_COUNT:1,RESCALE_Y:!0,MARGIN_RIGHT:10,MARGIN_LEFT:10,MARGIN_LABEL:10,MARGIN_AXES:5,MARGIN_TICK:2},this.data=s.map(i,e),this.X=s.map(this.data,n=>n.x),this.start=0,this.end=this.data.length-1}animationDuration(i){return this.config.DURATION_MS=i,this}noAnimation(){return this.animationDuration(0)}doNotRescaleY(){return this.config.RESCALE_Y=!1,this}setBandPadding(i){return this.config.BAND_PAD=i,this}priceAxisRight(){return this.config.PRICE_AXIS_RIGHT=!0,this}showVolume(i=.1){return this.config.VOLUME_RATIO=i,this}hideVolume(){return this.showVolume(0)}hideVolumeAxis(){return this.config.HIDE_VOLUME_AXIS=!0,this}volumeTickCount(i=1){return this.config.VOLUME_TICK_COUNT=i,this}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}screenHeightPercent(i){return this.config.SCREEN_HEIGHT_PERCENT=i,this}get volumeAxesIsVisible(){return!!this.config.VOLUME_RATIO&&!this.config.HIDE_VOLUME_AXIS}get volumeAxesVisibility(){return this.volumeAxesIsVisible?"visible":"hidden"}get priceTickFormat(){if(this.config.LOG_Y){let i=s.max([this.scaleLinear.ticks().length,2]);return this.scaleLog.tickFormat(i,this.priceFormat)}else return this.priceFormat}get priceAxisIndex(){return this.config.PRICE_AXIS_RIGHT?s.axisRight(this.scaleY).tickFormat(this.priceTickFormat):s.axisLeft(this.scaleY).tickFormat(this.priceTickFormat)}get gridWidth(){return-this.layout.innerWidth-this.config.MARGIN_AXES}get wickThickness(){return s.max([this.scaleX.bandwidth()*.01,1])}render(i){if(!this.data.length)return;[this.svg,this.layout]=F(i,this.config);let e=this.layout.innerHeight*this.config.VOLUME_RATIO,n=this.layout.innerHeight-e,a=s.max(s.map(this.data,g=>g.v));if(this.scaleVolume=s.scaleLinear().domain([0,a]).range([e,0]).clamp(!0).nice(),this.volumeAxesIsVisible){let[g,gt]=_(this.svg,this.layout,this.scaleVolume.copy(),X,"v axis");this.layout.pad.right=g+this.config.MARGIN_RIGHT}let o=V(this.data),r=o[0],l=[n,0];this.scaleLinear=s.scaleLinear().domain(o).range(l).clamp(!0),this.scaleLog=s.scaleLog().domain(o).range(l).clamp(!0);let[h,c]=_(this.svg,this.layout,this.scaleLog.copy(),this.priceFormat,"y axis"),[u,x]=_(this.svg,this.layout,this.scaleLinear.copy(),this.priceFormat,"y axis"),k=s.max([h,u]);this.config.PRICE_AXIS_RIGHT?(this.layout.pad.left=this.config.MARGIN_LEFT,this.layout.pad.right=s.max([this.layout.pad.right,k+this.config.MARGIN_RIGHT])):this.layout.pad.left=s.max([this.layout.pad.left,k+this.config.MARGIN_LEFT]),this.svg.append("defs").append("clipPath").attr("id","inner-clip-path").append("rect").attr("width",this.layout.innerWidth).attr("height",this.layout.innerHeight),this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.pad.left}, ${this.layout.pad.top})`),this.scaleX=s.scaleBand(this.X,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PAD).align(.5);let R=b(),[U,ut]=_(this.svg,this.layout,this.scaleX.copy(),R,"x axis");this.labelWidthX=U+this.config.MARGIN_LABEL;let P=L(this.X,this.layout,this.labelWidthX);R=b(),this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let v=this.priceAxisIndex;this.axisX=s.axisBottom(this.scaleX).tickValues(P).tickFormat(R).tickSize(3);let w="transform(0,0)";this.config.PRICE_AXIS_RIGHT&&(w=`translate(${this.layout.innerWidth+this.config.MARGIN_AXES},0)`),this.gPrice=this.inner.append("g").attr("transform",w).attr("class","y axis").call(v.tickSize(0)),this.grid=this.inner.append("g").attr("transform",w).attr("class","grid").call(v.tickSize(this.gridWidth));let B=this.scaleX.bandwidth()*this.config.BAND_PAD/2;this.gx=this.inner.append("g").attr("class","x axis").attr("transform",`translate(${B+.5},${this.layout.innerHeight+this.config.MARGIN_TICK})`).call(this.axisX),this.price=this.inner.append("g").attr("class","price"),this.candles=this.price.append("g").attr("clip-path","url(#inner-clip-path)").attr("stroke-linecap","butt").attr("stroke","currentColor").selectAll("g").data(this.data).join("g").attr("class",G).attr("transform",g=>`translate(${this.scaleX(g.x)+this.scaleX.step()/2},0)`),this.wicks=this.candles.append("line").attr("stroke-width",this.wickThickness).attr("class","wick").attr("y1",this.scaleY(r)).attr("y2",this.scaleY(r)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class","bar").attr("y1",this.scaleY(r)).attr("y2",this.scaleY(r)),this.axisVolume=s.axisRight(this.scaleVolume).ticks(this.config.VOLUME_TICK_COUNT).tickFormat(X).tickSize(3),this.volume=this.inner.append("g").attr("class","volume").attr("transform",`translate(0,${this.layout.innerHeight-e})`),this.gVolume=this.volume.append("g").attr("class","v axis").attr("transform",`translate(${this.layout.innerWidth+this.config.MARGIN_TICK},0)`).call(this.axisVolume).attr("visibility",this.volumeAxesVisibility),this.volumeSlots=this.volume.append("g").attr("clip-path","url(#inner-clip-path)").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",g=>`translate(${this.scaleX(g.x)+this.scaleX.step()/2},0)`),this.volumeBars=this.volumeSlots.append("line").attr("y1",this.scaleVolume(0)).attr("y2",this.scaleVolume(0)).attr("stroke-width",this.scaleX.bandwidth()).attr("class",G),this.brush=s.brushX().extent([[0,0],[this.layout.innerWidth,this.layout.innerHeight]]).on("end",this.zoom.bind(this)),this.gBrush=this.inner.append("g").attr("class","brush").call(this.brush.bind(this)),this.spotlightBar=this.inner.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none"),this.update()}update(){let i=ht(this.scaleX.domain(),this.layout.innerWidth,this.start,this.end);if(this.scaleX.range(i),this.config.RESCALE_Y){let r=V(this.data,this.start,this.end);this.scaleLinear.domain(r),this.scaleLog.domain(r)}this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let e=this.priceAxisIndex,n=L(this.X.slice(this.start,this.end+1),this.layout,this.labelWidthX),a=b();this.axisX.tickValues(n).tickFormat(a);let o=this.scaleX.bandwidth()*this.config.BAND_PAD/2;this.gx.transition().duration(this.config.DURATION_MS).attr("transform",`translate(${o+.5},${this.layout.innerHeight+this.config.MARGIN_TICK})`).call(this.axisX),this.gPrice.transition().duration(this.config.DURATION_MS).call(e.tickSize(0)),this.grid.transition().duration(this.config.DURATION_MS).call(e.tickFormat("").tickSize(this.gridWidth)),this.candles.transition().duration(this.config.DURATION_MS).attr("transform",r=>`translate(${this.scaleX(r.x)+this.scaleX.step()/2},0)`),this.bars.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()).attr("y1",r=>this.scaleY(r.o)).attr("y2",r=>this.scaleY(r.c)),this.wicks.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.wickThickness).attr("y1",r=>this.scaleY(r.l)).attr("y2",r=>this.scaleY(r.h)),this.noSpotlight(),this.spotlightBar.transition().duration(this.config.DURATION_MS).attr("width",this.scaleX.step()),this.volumeSlots.transition().duration(this.config.DURATION_MS).attr("transform",r=>`translate(${this.scaleX(r.x)+this.scaleX.step()/2},0)`),this.volumeBars.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()).attr("y2",r=>this.scaleVolume(r.v||0))}zoom({selection:i}){if(!i)return;let[e,n]=i;[this.start,this.end]=[S(this.scaleX,e),S(this.scaleX,n)],this.update(),this.gBrush.call(this.brush.move,null)}reset(){this.start=0,this.end=this.data.length-1,this.update()}useLog(){this.config.LOG_Y=!0,this.update()}useLinear(){this.config.LOG_Y=!1,this.update()}spotlight(i){this.spotlightBar.attr("x",this.scaleX(this.data[i].x)).attr("width",this.scaleX.step()).attr("y",0).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}onEvent(i,e){let n=null,a=r=>{let[l]=s.pointer(r),h=S(this.scaleX,l-this.layout.pad.left);if(n&&n==h)return;n=h;let c=structuredClone(this.data[h]);if(c.index=h,h>0){let u=this.data[h-1];u&&u.c&&(c.prev=u.c,c.delta=c.c-u.c,c.percent=c.delta/u.c)}i&&i.call(this,c)},o=r=>{n=null,e&&e.call(this)};this.svg.on("pointermove",H(a,20.83)).on("pointerleave",o)}append(){}};function lt(t,i){return new A(t,i)}function ct(t,i){return new A(t,i).showVolume()}return J(dt);})();
//# sourceMappingURL=candlestick.min.js.map
