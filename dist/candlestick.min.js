var charts=(()=>{var it=Object.create;var L=Object.defineProperty;var et=Object.getOwnPropertyDescriptor;var st=Object.getOwnPropertyNames;var nt=Object.getPrototypeOf,rt=Object.prototype.hasOwnProperty;var ot=(i,e,t)=>e in i?L(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var at=(i,e)=>()=>(e||i((e={exports:{}}).exports,e),e.exports),ht=(i,e)=>{for(var t in e)L(i,t,{get:e[t],enumerable:!0})},v=(i,e,t,s)=>{if(e&&typeof e=="object"||typeof e=="function")for(let r of st(e))!rt.call(i,r)&&r!==t&&L(i,r,{get:()=>e[r],enumerable:!(s=et(e,r))||s.enumerable});return i};var m=(i,e,t)=>(t=i!=null?it(nt(i)):{},v(e||!i||!i.__esModule?L(t,"default",{value:i,enumerable:!0}):t,i)),lt=i=>v(L({},"__esModule",{value:!0}),i);var C=(i,e,t)=>ot(i,typeof e!="symbol"?e+"":e,t);var f=at((Tt,H)=>{H.exports=d3});var Lt={};ht(Lt,{CandlestickChart:()=>I,OHLC:()=>yt,OHLCV:()=>At,parseArrayOHLCV:()=>W,parseVerboseOHLCV:()=>P,placeTooltip:()=>K,placeTooltipTop:()=>Z});var o=m(f());var y=m(f());function F(i,e){if(i=i||[],!i.length)return`${e} ${e}`;i.length%2&&(i=i.concat(i));let t=i.join(" "),s=y.sum(i);if(!s)return`${e} ${e}`;let r=Math.ceil(e/s);return`${new Array(r).fill(t).join(" ")} 0 ${Math.ceil(e)}`}function V(i,e){i=i||[],i.length%2&&(i=i.concat(i));let t=y.sum(i);return t?s=>Math.round((1-s)*e/t)*t:y.interpolate(e,0)}var U=m(f());var ct=m(f());var S=class{constructor(e,t=s=>s){}screenHeightPercent(e){return this.config.LAYOUT.screenHeightPercent=e,this}minHeight(e){return this.config.LAYOUT.minHeight=e,this}maxHeight(e){return this.config.LAYOUT.maxHeight=e,this}height(e){return this.minHeight(e).maxHeight(e)}minWidth(e){return this.config.LAYOUT.minWidth=e,this}maxWidth(e){return this.config.LAYOUT.maxWidth=e,this}width(e){return this.minWidth(e).maxWidth(e)}animationDuration(e){return this.config.DURATION_MS=e,this}noAnimation(){return this.config.DELAY_MS=0,this.animationDuration(0)}node(){return this.svg?this.svg.node():null}};var D=m(f()),Rt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,Mt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,Xt=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,dt=D.format(",.0f"),Et=D.format(",.2f"),Y=function(i){if(i)return i>=1e9?`${i/1e9}B`:i>=1e6?`${i/1e6}M`:dt(i)};var u=m(f()),k=class{constructor(e,t,s,r){this.top=e,this.right=t,this.bottom=s,this.left=r}};function B(){return new k(15,15,25,25)}var _=class{constructor(e,t,s){this.width=e,this.height=t,this.pad=s||B()}get rangeX(){return[this.pad.left,this.width-this.pad.right]}get rangeY(){return[this.height-this.pad.bottom,this.pad.top]}get innerWidth(){return this.width-this.pad.left-this.pad.right}get innerHeight(){return this.height-this.pad.top-this.pad.bottom}get innerMinimum(){return u.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function N(i,{minWidth:e=400,maxWidth:t=void 0,minHeight:s=300,maxHeight:r=void 0,screenHeightPercent:n=.5}={}){let l=document.querySelector(i),h=u.max([l.offsetWidth,e]);t&&(h=u.min([h,t]));let c=window.innerHeight*n;return c=u.max([c,s]),r&&(c=u.min([c,r])),new _(h,c,B())}function ut(i,e,t){return u.select(i).append("svg").attr("viewBox",`0 0 ${e} ${t}`).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent")}function G(i,e){let t=u.select(i);if(!t.node())throw new Error(`Unable to find a DOM element for selector '${i}'`);if(t.node().tagName==="svg"){let n=t,l=+n.attr("width"),h=+n.attr("height");if(l&&h)return[n,new _(l,h)];{let c=N(i,e);return[n,c]}}let s=N(i,e);return[ut(i,s.width,s.height),s]}var R=m(f());function W(i){return{x:R.isoParse(i[0]),o:i[1],h:i[2],l:i[3],c:i[4],v:i[5]}}function P(i){return{x:R.isoParse(i.date),o:i.open,h:i.high,l:i.low,c:i.close,v:i.volume}}function M(i,e){var t=!0;return function(){t&&(i.apply(this,arguments),t=!1,setTimeout(()=>{t=!0},e))}}var A=m(f());function w(i,e,t,s=null,r=""){let n=i.append("g").attr("width",e.innerWidth).attr("height",e.innerHeight).attr("class",r).style("visibility","hidden"),l=A.axisLeft(t).tickFormat(s),c=n.call(l).selectAll(".tick text"),d=0,a=0;return c.each(function(){let g=this.getBoundingClientRect();g.width>d&&(d=g.width),g.height>a&&(a=g.height)}),n.remove(),[d,a]}function $(i,e,t){let s=parseInt(e.innerWidth/(t+1))+1,r=A.max([parseInt(Math.ceil(i.length/s)),1]),n=r>1?Math.floor(r/2):0;return A.filter(i,(l,h)=>h-n>=0&&(h-n)%r===0)}function T(i,e){let t=i.domain(),s=Math.floor((e-i(t[0]))/i.step());return Math.max(0,Math.min(s,t.length-1))}function z(i,e,t,s){let r=s-t+1,n=1;r<i.length&&(n=i.length/r);let l=e*n,h=t/i.length*l;return[0-h,l-h]}var x=m(f()),Ut=x.utcFormat("%b"),gt=x.utcFormat("%b %-d"),Nt=x.utcFormat("%b %Y"),ft=x.utcFormat("%b %-d, %Y"),Bt=x.utcFormat("%B %-d, %Y");function q(){let i=null;return function(e){let t=e.getUTCFullYear();return i!==t?(i=t,ft(e)):gt(e)}}function K(i,e,t,s,r=5){let n=i.getBoundingClientRect(),l=t-n.left-window.scrollX,h=s-n.top-window.scrollY,c=r,d=-e.offsetHeight-r,a="left";return l>n.width-e.offsetWidth-r&&(c=-e.offsetWidth-r,a="right"),h<e.offsetHeight+r&&(d=r),[t+c,s+d,a]}function Z(i,e,t,s,r=5){let n=i.getBoundingClientRect(),l=t-n.left-window.scrollX,h=r,c=-e.offsetHeight-r,d="left";return l>n.width-e.offsetWidth-r&&(h=-e.offsetWidth-r,d="right"),[t+h,s+c,d]}var pt=0;function mt(i){return 1+Math.sign(i.o-i.c)}var xt=["up","even","down"];function j(i){return xt[mt(i)]}function Q(i,e=0,t){return t&&(i=i.slice(e,t+1)),[o.min(o.map(i,r=>r.l)),o.max(o.map(i,r=>r.h))]}var I=class extends S{constructor(t,s=r=>r){super(t,s);C(this,"priceFormat",o.format(",~f"));this.config={VOLUME_RATIO:0,LOG_Y:!1,BAND_PAD:.1,FPS:48,DURATION_MS:750,DELAY_MS:0,DELAY_ONCE:!1,DISABLE_BRUSH:!1,PRICE_AXIS_RIGHT:!1,VOLUME_AXIS_RIGHT:!0,HIDE_VOLUME_AXIS:!1,VOLUME_TICK_COUNT:1,RESCALE_Y:!0,CLAMP:!1,LAYOUT:{},STROKE_WIDTH:1.5,MARGIN_RIGHT:10,MARGIN_LEFT:10,MARGIN_LABEL:10,MARGIN_AXES:5,MARGIN_TICK:2},this.opened=!1,this.data=o.map(t,s),this.lines={},this.lineElements={},this.X=o.map(this.data,r=>r.x),this.start=0,this.end=this.data.length-1}doNotRescaleY(){return this.config.RESCALE_Y=!1,this}bandPadding(t){return this.config.BAND_PAD=t,this}priceAxisRight(){return this.config.PRICE_AXIS_RIGHT=!0,this}showVolume(t=.1){return this.config.VOLUME_RATIO=t,this}hideVolume(){return this.showVolume(0)}hideVolumeAxis(){return this.config.HIDE_VOLUME_AXIS=!0,this}volumeTickCount(t=1){return this.config.VOLUME_TICK_COUNT=t,this}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}disableZoom(){return this.config.DISABLE_BRUSH=!0,this}enableClamp(){return this.config.CLAMP=!0,this}disableClamp(){return this.config.CLAMP=!1,this}staggerOpening(t=0){return this.config.DELAY_ONCE=!0,this.staggerAnimation(t)}staggerAnimation(t=0){return!t&&this.X.length&&(t=this.config.DURATION_MS/(2*this.X.length)),this.config.DELAY_MS=t,this}noStaggerAnimation(){return this.config.DELAY_MS=0,this}duration(t,s){return this.config.DELAY_ONCE&&this.opened?this.config.DURATION_MS:this.config.DURATION_MS/2}delay(t,s){return this.config.DELAY_ONCE&&this.opened?0:s*this.config.DELAY_MS}get volumeAxesIsVisible(){return!!this.config.VOLUME_RATIO&&!this.config.HIDE_VOLUME_AXIS}get volumeAxesVisibility(){return this.volumeAxesIsVisible?"visible":"hidden"}get priceTickFormat(){if(this.config.LOG_Y){let t=o.max([this.scaleLinear.ticks().length,2]);return this.scaleLog.tickFormat(t,this.priceFormat)}else return this.priceFormat}get priceAxisIndex(){return this.config.PRICE_AXIS_RIGHT?o.axisRight(this.scaleY).tickFormat(this.priceTickFormat):o.axisLeft(this.scaleY).tickFormat(this.priceTickFormat)}get gridWidth(){return-this.layout.innerWidth-this.config.MARGIN_AXES}get wickThickness(){return o.min([o.max([this.scaleX.bandwidth()*.03,1]),10])}makeDateFormatter(){return q()}get xValues(){return $(this.X.slice(this.start,this.end+1),this.layout,this.labelWidthX)}updateLayout(){}addLineAbove(t,s="currentColor",r,n){return this.addLine(t,s,!0,r,n)}addLineBelow(t,s="currentColor",r,n){return this.addLine(t,s,!1,r,n)}addLine(t,s="currentColor",r=!1,n,l){return this.lines[t]={color:s,above:r,pattern:n,strokeWidth:l||this.config.STROKE_WIDTH},this}getLine(t){return this.lineElements[t]}setLineOpacity(t,s=1){return this.getLine(t).attr("opacity",s)}showLine(t){return this.setLineOpacity(t,1)}hideLine(t){return this.setLineOpacity(t,0)}moveLineBelow(t){let s=this.getLine(t);return this.lineBelow.append(()=>s.node().parentNode),s}moveLineAbove(t){let s=this.getLine(t);return this.lineAbove.append(()=>s.node().parentNode),s}renderLine(t,s,r){let n=this.lines[t],l=n.above?this.lineAbove.append("g"):this.lineBelow.append("g"),h=o.group(this.data,()=>t),c=o.line().digits(3).defined(a=>a.x&&a[t]).x(a=>s(a.x)+s.step()/2).y(a=>r(a[t])),d=l.attr("fill","none").attr("stroke-width",n.strokeWidth).attr("stroke",n.color).attr("opacity",1).selectAll("path").data(h).join("path").attr("d",([,a])=>c(a));return this.lineElements[t]=d,d}updateLine(t,s,r){let n=this.getLine(t),l=this.lines[t],h=l.pattern||[],c=o.line().digits(3).defined(a=>a.x&&a[t]).x(a=>s(a.x)+s.step()/2).y(a=>r(a[t]));this.opened&&n.attr("stroke-dasharray",h.length?h.join(" "):null).attr("stroke-dashoffset",0);let d=n.transition().duration(this.config.DURATION_MS);if(d.attr("d",([,a])=>c(a)),!this.opened){let a=Math.ceil(n.node().getTotalLength());n.attr("stroke-dasharray",F(l.pattern,a)),d.attrTween("stroke-dashoffset",()=>V(h,a))}return n}render(t){if(!this.data.length)return;let s=`candlestick-clip-path-${pt++}`;[this.svg,this.layout]=G(t,this.config.LAYOUT);let r=this.layout.innerHeight*this.config.VOLUME_RATIO,n=this.layout.innerHeight-r,l=o.max(o.map(this.data,p=>p.v));if(this.scaleVolume=o.scaleLinear().domain([0,l]).range([r,0]).clamp(this.config.CLAMP).nice(),this.volumeAxesIsVisible){let[p,St]=w(this.svg,this.layout,this.scaleVolume.copy(),Y,"v axis");this.layout.pad.right=p+this.config.MARGIN_RIGHT}let h=Q(this.data),c=h[0],d=[n,0];this.scaleLinear=o.scaleLinear().domain(h).range(d).clamp(this.config.CLAMP),this.scaleLog=o.scaleLog().domain(h).range(d).clamp(this.config.CLAMP);let[a,g]=w(this.svg,this.layout,this.scaleLog.copy(),this.priceFormat,"y axis"),[J,wt]=w(this.svg,this.layout,this.scaleLinear.copy(),this.priceFormat,"y axis"),X=o.max([a,J]);this.config.PRICE_AXIS_RIGHT?(this.layout.pad.left=this.config.MARGIN_LEFT,this.layout.pad.right=o.max([this.layout.pad.right,X+this.config.MARGIN_RIGHT])):this.layout.pad.left=o.max([this.layout.pad.left,X+this.config.MARGIN_LEFT]),this.svg.append("defs").append("clipPath").attr("id",s).append("rect").attr("width",this.layout.innerWidth).attr("height",this.layout.innerHeight),this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.pad.left}, ${this.layout.pad.top})`),this.scaleX=o.scaleBand(this.X,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PAD).paddingOuter(this.config.BAND_PAD/2);let b=this.makeDateFormatter(),[tt,It]=w(this.svg,this.layout,this.scaleX.copy(),b,"x axis");this.labelWidthX=tt+this.config.MARGIN_LABEL;let O="transform(0,0)";this.config.PRICE_AXIS_RIGHT&&(O=`translate(${this.layout.innerWidth+this.config.MARGIN_AXES},0)`),b=this.makeDateFormatter(),this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let E=this.priceAxisIndex;this.grid=this.inner.append("g").attr("transform",O).attr("class","grid").call(E.tickSize(this.gridWidth)),this.axisX=o.axisBottom(this.scaleX).tickValues(this.xValues).tickFormat(b).tickSize(4),this.gPrice=this.inner.append("g").attr("transform",O).attr("class","y axis").call(E.tickSize(0)),this.axisVolume=o.axisRight(this.scaleVolume).ticks(this.config.VOLUME_TICK_COUNT).tickFormat(Y).tickSize(3),this.volume=this.inner.append("g").attr("class","volume").attr("transform",`translate(0,${this.layout.innerHeight-r})`),this.gVolume=this.volume.append("g").attr("class","v axis").attr("transform",`translate(${this.layout.innerWidth+this.config.MARGIN_TICK},0)`).call(this.axisVolume).attr("visibility",this.volumeAxesVisibility),this.volumeSlots=this.volume.append("g").attr("clip-path",`url(#${s})`).attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",p=>`translate(${this.scaleX(p.x)+this.scaleX.bandwidth()/2},0)`),this.volumeBars=this.volumeSlots.append("line").attr("y1",this.scaleVolume(0)).attr("y2",this.scaleVolume(0)).attr("stroke-width",this.scaleX.bandwidth()).attr("class",j),this.lineBelow=this.inner.append("g").attr("clip-path",`url(#${s})`).attr("class","lineBelow"),this.price=this.inner.append("g").attr("class","price"),this.candles=this.price.append("g").attr("clip-path",`url(#${s})`).attr("stroke-linecap","butt").attr("stroke","currentColor").selectAll("g").data(this.data).join("g").attr("class",j).attr("transform",p=>`translate(${this.scaleX(p.x)+this.scaleX.bandwidth()/2},0)`),this.wicks=this.candles.append("line").attr("stroke-width",this.wickThickness).attr("class","wick").attr("y1",this.scaleY(c)).attr("y2",this.scaleY(c)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class","bar").attr("y1",this.scaleY(c)).attr("y2",this.scaleY(c)),this.lineAbove=this.inner.append("g").attr("clip-path",`url(#${s})`).attr("class","lineAbove"),this.gx=this.inner.append("g").attr("class","x axis").attr("transform",`translate(0,${this.layout.innerHeight})`).call(this.axisX);for(let p in this.lines)this.renderLine(p,this.scaleX,this.scaleY);this.brush=o.brushX().extent([[0,0],[this.layout.innerWidth,this.layout.innerHeight]]),this.gBrush=this.inner.append("g").attr("class","brush"),this.config.DISABLE_BRUSH||(this.brush.on("end",this.zoom.bind(this)),this.gBrush.call(this.brush.bind(this))),this.spotlightBar=this.inner.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none"),this.update()}update(){let t=z(this.scaleX.domain(),this.layout.innerWidth,this.start,this.end);if(this.scaleX.range(t),this.config.RESCALE_Y){let n=Q(this.data,this.start,this.end);this.scaleLinear.domain(n),this.scaleLog.domain(n)}this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let s=this.priceAxisIndex,r=this.makeDateFormatter();this.axisX.tickValues(this.xValues).tickFormat(r),this.gx.transition().duration(this.config.DURATION_MS).attr("transform",`translate(0,${this.layout.innerHeight})`).call(this.axisX),this.gPrice.transition().duration(this.config.DURATION_MS).call(s.tickSize(0)),this.grid.transition().duration(this.config.DURATION_MS).call(s.tickFormat("").tickSize(this.gridWidth)),this.candles.transition().duration(this.config.DURATION_MS).attr("transform",n=>`translate(${this.scaleX(n.x)+this.scaleX.bandwidth()/2},0)`),this.bars.transition().delay(this.delay.bind(this)).duration(this.duration.bind(this)).attr("stroke-width",this.scaleX.bandwidth()).attr("y1",n=>this.scaleY(n.o)).attr("y2",n=>this.scaleY(n.c)),this.wicks.transition().delay(this.delay.bind(this)).duration(this.duration.bind(this)).attr("stroke-width",this.wickThickness).attr("y1",n=>this.scaleY(n.l)).attr("y2",n=>this.scaleY(n.h)),this.noSpotlight(),this.spotlightBar.transition().duration(this.config.DURATION_MS).attr("width",this.scaleX.step()),this.volumeSlots.transition().duration(this.config.DURATION_MS).attr("transform",n=>`translate(${this.scaleX(n.x)+this.scaleX.bandwidth()/2},0)`),this.volumeBars.transition().delay(this.delay.bind(this)).duration(this.duration.bind(this)).attr("stroke-width",this.scaleX.bandwidth()).attr("y2",n=>this.scaleVolume(n.v||0));for(let n in this.lines)this.updateLine(n,this.scaleX,this.scaleY);this.opened=!0}zoom({selection:t}){if(!t)return;let[s,r]=t;[this.start,this.end]=[T(this.scaleX,s),T(this.scaleX,r)],this.update(),this.gBrush.call(this.brush.move,null)}reset(){this.start=0,this.end=this.data.length-1,this.update()}useLog(){this.config.LOG_Y=!0,this.update()}useLinear(){this.config.LOG_Y=!1,this.update()}spotlight(t){let s=this.scaleX.step()*this.scaleX.paddingOuter();this.spotlightBar.attr("x",this.scaleX(this.data[t].x)-s).attr("width",this.scaleX.step()).attr("y",0).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}onEvent(t,s){let r=null,n=h=>{h.touches&&(h.preventDefault(),h=h.touches[0]);let[c]=o.pointer(h),d=T(this.scaleX,c-this.layout.pad.left);r=d;let a=structuredClone(this.data[d]);if(a.index=d,[a.px,a.py]=o.pointer(h,null),d>0){let g=this.data[d-1];g&&g.c&&(a.prev=g.c,a.delta=a.c-g.c,a.percent=a.delta/g.c)}t&&t.call(this,a,h)},l=h=>{r=null,s&&s.call(this,h)};this.svg.on("mousemove",M(n,1e3/this.config.FPS)).on("mouseleave",l).on("touchstart",n,{passive:!1}).on("touchmove",M(n,1e3/this.config.FPS),{passive:!1}).on("touchend",l,{passive:!1})}append(){}};function yt(i,e){return new I(i,e)}function At(i,e){return new I(i,e).showVolume()}return lt(Lt);})();
//# sourceMappingURL=candlestick.min.js.map
