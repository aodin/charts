var charts=(()=>{var z=Object.create;var g=Object.defineProperty;var G=Object.getOwnPropertyDescriptor;var P=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var Z=(i,t,e)=>t in i?g(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var K=(i,t)=>()=>(t||i((t={exports:{}}).exports,t),t.exports),Q=(i,t)=>{for(var e in t)g(i,e,{get:t[e],enumerable:!0})},A=(i,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of P(t))!j.call(i,a)&&a!==e&&g(i,a,{get:()=>t[a],enumerable:!(n=G(t,a))||n.enumerable});return i};var w=(i,t,e)=>(e=i!=null?z(q(i)):{},A(t||!i||!i.__esModule?g(e,"default",{value:i,enumerable:!0}):e,i)),J=i=>A(g({},"__esModule",{value:!0}),i);var L=(i,t,e)=>Z(i,typeof t!="symbol"?t+"":t,e);var f=K((mt,O)=>{O.exports=d3});var lt={};Q(lt,{Candlestick:()=>b,OHLC:()=>ot,OHLCV:()=>ht,parseArray:()=>at,parseVerboseObject:()=>rt});var s=w(f());var u=w(f()),Y=class{constructor(t,e,n,a){this.top=t,this.right=e,this.bottom=n,this.left=a}};function T(){return new Y(15,15,25,25)}var x=class{constructor(t,e,n){this.width=t,this.height=e,this.pad=n||T()}get rangeX(){return[this.pad.left,this.width-this.pad.right]}get rangeY(){return[this.height-this.pad.bottom,this.pad.top]}get innerWidth(){return this.width-this.pad.left-this.pad.right}get innerHeight(){return this.height-this.pad.top-this.pad.bottom}get innerMinimum(){return u.min([this.innerWidth,this.innerHeight])}get midpoint(){return[this.width/2,this.height/2]}};function _(i,{minWidth:t=400,maxWidth:e=void 0,minHeight:n=300,maxHeight:a=void 0,screenHeightFraction:h=.5}={}){let c=document.querySelector(i),l=u.max([c.offsetWidth,t]);e&&(l=u.min([l,e]));let r=window.innerHeight*h;return r=u.max([r,n]),a&&(r=u.min([r,a])),new x(l,r,T())}function k(i,t,e){return u.select(i).append("svg").attr("viewBox",[0,0,t,e]).attr("style","max-width: 100%; height: intrinsic;").style("-webkit-tap-highlight-color","transparent").style("overflow","visible")}function y(i,t,e=null){let n=d3.select("body").append("svg").attr("width",i.innerWidth).attr("height",i.innerHeight).style("visibility","hidden"),a=d3.axisLeft(t).tickFormat(e),c=n.append("g").call(a).selectAll(".tick text"),l=0,r=0;return c.each(function(){let d=this.getBoundingClientRect();d.width>l&&(l=d.width),d.height>r&&(r=d.height)}),n.remove(),[l,r]}function F(i,t,e){let n=parseInt(t.innerWidth/(e+1))+1,a=d3.max([parseInt(Math.ceil(i.length/n)),1]);return d3.filter(i,(h,c)=>c%a===0)}var m=w(f()),xt=m.utcFormat("%b"),tt=m.utcFormat("%b %-d"),yt=m.utcFormat("%b %Y"),it=m.utcFormat("%b %-d, %Y"),bt=m.utcFormat("%B %-d, %Y");function v(){let i=null;return function(t){let e=t.getUTCFullYear();return i!==e?(i=e,it(t)):tt(t)}}function H(i,t){var e=!0;return function(){e&&(i.apply(this,arguments),e=!1,setTimeout(()=>{e=!0},t))}}var M=w(f()),It=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:0,maximumFractionDigits:2}).format,Yt=new Intl.NumberFormat("en-US",{style:"percent",minimumFractionDigits:2,maximumFractionDigits:2,signDisplay:"exceptZero"}).format,_t=new Intl.NumberFormat("en-US",{notation:"compact",compactDisplay:"short",minimumFractionDigits:1,maximumFractionDigits:2}).format,et=M.format(",.0f"),D=function(i){if(i)return i>=1e9?`${i/1e9}B`:i>=1e6?`${i/1e6}M`:et(i)};function st(i){return 1+Math.sign(i.o-i.c)}function R(i){return["bar",["up","even","down"][st(i)]].join(" ")}function nt(i,t,e,n){let a=n-e+1,h=1;a<i.length&&(h=i.length/a);let c=e/i.length,l=t*h,r=c*l;return[0-r,l-r]}function U(i,t=0,e){return e&&(i=i.slice(t,e)),[s.min(s.map(i,a=>a.l)),s.max(s.map(i,a=>a.h))]}function at(i){return{x:s.isoParse(i[0]),o:i[1],h:i[2],l:i[3],c:i[4],v:i[5]}}function rt(i){return{x:s.isoParse(i.date),o:i.open,h:i.high,l:i.low,c:i.close,v:i.volume}}function S(i,t){let e=i.domain(),n=i(e[0]),a=i.step(),h=Math.floor((t-n)/a);return Math.max(0,Math.min(h,e.length-1))}var b=class{constructor(t,e=n=>n){L(this,"formatX","%m %d, %Y");this.config={VOLUME_RATIO:0,LOG_Y:!1,SCREEN_HEIGHT_FRACTION:.5,BAND_PAD:.2,DURATION_MS:500,VOLUME_AXIS_RIGHT:!0,HIDE_VOLUME_AXIS:!1},this.data=s.map(t,e)}append(){}animationDuration(t){return this.config.DURATION_MS=t,this}noAnimation(){return this.animationDuration(0)}showVolume(t=.1){return this.config.VOLUME_RATIO=t,this}hideVolume(){return this.showVolume(0)}hideVolumeAxis(){return this.config.HIDE_VOLUME_AXIS=!0,this}defaultLog(){return this.config.LOG_Y=!0,this}defaultLinear(){return this.config.LOG_Y=!1,this}screenHeightFraction(t){return this.config.SCREEN_HEIGHT_FRACTION=t,this}render(t){let e=s.select(t);if(!e.node())throw new Error(`Unable to find a DOM element for selector '${t}'`);if(e.node().tagName==="svg"){this.svg=e;let o=+this.svg.attr("width"),I=+this.svg.attr("height");o&&I?this.layout=new x(o,I):this.layout=_(t,{screenHeightFraction:this.config.SCREEN_HEIGHT_FRACTION})}else this.layout=_(t,{screenHeightFraction:this.config.SCREEN_HEIGHT_FRACTION}),this.svg=k(t,this.layout.width,this.layout.height);let n=this.layout.innerHeight*this.config.VOLUME_RATIO,a=this.layout.innerHeight-n,h=s.max(s.map(this.data,o=>o.v));if(this.scaleVolume=s.scaleLinear().domain([0,h]).range([n,0]).clamp(!0).nice(),!this.config.HIDE_VOLUME_AXIS){let[o,I]=y(this.layout,this.scaleVolume,D);this.layout.pad.right=o+5}let c=U(this.data),l=c[0],r=[a,0];this.scaleLog=s.scaleLog().domain(c).range(r).clamp(!0),this.scaleLinear=s.scaleLinear().domain(c).range(r).clamp(!0);let d=s.map(this.data,o=>o.x),[p,ct]=y(this.layout,this.scaleLog),[E,dt]=y(this.layout,this.scaleLinear),N=s.max([p,E]);this.layout.pad.left=N+5,this.inner=this.svg.append("g").attr("transform",`translate(${this.layout.pad.left}, ${this.layout.pad.top})`),this.price=this.inner.append("g").attr("class","price"),this.volume=this.inner.append("g").attr("class","volume").attr("transform",`translate(0,${this.layout.innerHeight-n})`),this.scaleX=s.scaleBand(d,[0,this.layout.innerWidth]).paddingInner(this.config.BAND_PAD).align(.5);let X=v(),[V,ut]=y(this.layout,this.scaleX,X),C=s.map(this.data,o=>o.x),B=F(C,this.layout,V);X=v(),this.scaleY=this.config.LOG_Y?this.scaleLog:this.scaleLinear;let W=s.axisLeft(this.scaleY).tickSize(0);this.axisX=s.axisBottom(this.scaleX).tickValues(B).tickFormat(X).tickSize(3),this.gPrice=this.inner.append("g").attr("class","y axis").attr("transform","translate(0,0)").call(W).call(o=>o.selectAll(".tick line").clone().attr("stroke","#bbb").attr("stroke-opacity",.5).attr("x1",0).attr("x2",this.layout.innerWidth));let $=this.scaleX.bandwidth()*this.config.BAND_PAD/2;this.gx=this.inner.append("g").attr("class","x axis").attr("transform",`translate(${$+.5},${this.layout.innerHeight})`).call(this.axisX),this.candles=this.inner.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",o=>`translate(${this.scaleX(o.x)+this.scaleX.step()/2},0)`),this.wicks=this.candles.append("line").attr("stroke","currentColor").attr("stroke-width",1).attr("class","wick").attr("opacity",.8).attr("y1",this.scaleY(l)).attr("y2",this.scaleY(l)),this.bars=this.candles.append("line").attr("stroke-width",this.scaleX.bandwidth()).attr("class",o=>R(o)).attr("y1",this.scaleY(l)).attr("y2",this.scaleY(l)),this.updateY(),n&&(this.axisVolume=s.axisRight(this.scaleVolume).ticks(1).tickFormat(D).tickSize(3),this.config.HIDE_VOLUME_AXIS||this.volume.append("g").attr("transform",`translate(${this.layout.innerWidth},0)`).call(this.axisVolume),this.volumeSlots=this.volume.append("g").attr("stroke","currentColor").attr("stroke-linecap","butt").selectAll("g").data(this.data).join("g").attr("transform",o=>`translate(${this.scaleX(o.x)+this.scaleX.step()/2},0)`),this.volumeBars=this.volumeSlots.append("line").attr("y1",this.scaleVolume(0)).attr("y2",this.scaleVolume(0)).attr("stroke-width",this.scaleX.bandwidth()).attr("class",o=>R(o)),this.volumeBars.transition().duration(this.config.DURATION_MS).attr("y2",o=>this.scaleVolume(o.v||0))),this.brush=s.brushX().extent([[0,0],[this.layout.innerWidth,this.layout.innerHeight]]).on("end",this.zoom.bind(this)),this.gBrush=this.inner.append("g").attr("class","brush").call(this.brush.bind(this)),this.spotlightBar=this.inner.append("g").lower().attr("class","spotlight").append("rect").style("display","none").style("pointer-events","none")}updateY(){this.gPrice.transition().duration(this.config.DURATION_MS).call(s.axisLeft(this.scaleY).tickSize(0)),this.bars.transition().duration(this.config.DURATION_MS).attr("y1",t=>this.scaleY(t.o)).attr("y2",t=>this.scaleY(t.c)),this.wicks.transition().duration(this.config.DURATION_MS).attr("y1",t=>this.scaleY(t.l)).attr("y2",t=>this.scaleY(t.h))}useLog(){this.scaleY=this.scaleLog,this.updateY()}useLinear(){this.scaleY=this.scaleLinear,this.updateY()}spotlight(t){this.spotlightBar.attr("x",this.scaleX(this.data[t].x)).attr("width",this.scaleX.step()).attr("y",0).attr("height",this.layout.innerHeight).style("display","block")}noSpotlight(){this.spotlightBar.style("display","none")}onEvent(t,e){let n=null,a=c=>{let[l]=s.pointer(c),r=S(this.scaleX,l-this.layout.pad.left);if(n&&n==r)return;n=r;let d=structuredClone(this.data[r]);if(d.index=r,r>0){let p=this.data[r-1];p&&p.c&&(d.prev=p.c,d.delta=d.c-p.c,d.percent=d.delta/p.c)}t&&t.call(this,d)},h=c=>{n=null,e&&e.call(this)};this.svg.on("pointermove",H(a,20.83)).on("pointerleave",h)}updateX(t,e){let n=nt(this.scaleX.domain(),this.layout.innerWidth,t,e);this.scaleX.range(n);let a=U(this.data,t,e);this.gx.transition().duration(this.config.DURATION_MS).call(this.axisX),this.candles.transition().duration(this.config.DURATION_MS).attr("transform",h=>`translate(${this.scaleX(h.x)+this.scaleX.step()/2},0)`),this.bars.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth()),this.spotlightBar.transition().duration(this.config.DURATION_MS).attr("width",this.scaleX.step()),this.volumeSlots.transition().duration(this.config.DURATION_MS).attr("transform",h=>`translate(${this.scaleX(h.x)+this.scaleX.step()/2},0)`),this.volumeBars.transition().duration(this.config.DURATION_MS).attr("stroke-width",this.scaleX.bandwidth())}zoom({selection:t}){if(!t)return;let[e,n]=t,[a,h]=[S(this.scaleX,e),S(this.scaleX,n)];this.updateX(a,h),this.gBrush.call(this.brush.move,null)}reset(){this.updateX(0,this.scaleX.domain().length-1)}};function ot(i,t){return new b(i,t)}function ht(i,t){return new b(i,t).showVolume()}return J(lt);})();
//# sourceMappingURL=candlestick.min.js.map
